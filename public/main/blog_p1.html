<!DOCTYPE html>
<html>
  <head>
    <title>
      Blog
    </title>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../../static/style.css">

    <link rel="alternate" type="application/rss+xml" title="RSS feed for the blog" href="/rss.xml">

    <!--google-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MTNZ0ZSG3W"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MTNZ0ZSG3W');
    </script>

  </head>
  <body>
    <ul class="menu-list">
      <li class="menu-item"><a href="index.html" class="menu-link menu-title">Corin Wagen</a></li>
      <li class="menu-item"><a href="index.html#about" class="menu-link">About</a></li>
      <!--<li class="menu-item"><a href="index.html#projects" class="menu-link">Projects</a></li>-->
      <!--<li class="menu-item"><a href="index.html#past_work" class="menu-link">Past Work</a></li>-->
      <li class="menu-item">
        <a href="blog_p1.html" class="menu-link">Blog</a>
        <a href='archive.html' class="menu-link">(Archive)</a>
      </li>
    </ul>
    <h1 class='blogroll-header'>Blog</h1><div class='next-link'><a href='blog_p2.html'>next page</a></div><br><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20250724_satan.html'>Book Review: I See Satan Fall Like Lightning</a></h2><i>July 24, 2025</i>
<figure>
  <img class=centered-img src="../img/20250724_satan.jpg" style="width:400px;" />
  <figcaption>Gustave Doré, illustration for <i>Paradise Lost</i> (1866)</figcaption>
</figure>


<p>
In center-right tech-adjacent circles, it’s common to reference René Girard. This is in part owing to the influence of Girard’s student Peter Thiel. Thiel is one of the undisputed titans of Silicon Valley—founder of PayPal, Palantir, and Founders Fund; early investor and board member at Facebook; creator of the Thiel Fellowship; and mentor to J.D. Vance—and his intellectual influence has pushed Girard’s ideas into mainstream technology discourse. (One of Thiel’s few published writings is <a href=https://gwern.net/doc/politics/2007-thiel.pdf>“The Straussian Moment,”</a> a 2007 essay which explores the ideas of Girard and Leo Strauss in the wake of 9/11.)
</p>

<p>
  As a chemistry grad student exploring startup culture, I remember going to events and being confused why everyone kept describing things as “Girardian.” In part this is because Girard’s ideas are confusing. But the intrinsic confusingness of Girard is amplified by the fact that almost no one has actually read any of Girard’s writings. Instead, people learn what it means to be “Girardian” by listening to the term in conversation or on a podcast and, with practice, learn to start using it themselves.<sup>1</sup>
</p>

<figure>
  <img class=centered-img src="../img/20250724_he.png" style="width:450px;" />
  <figcaption>
    <a href=https://x.com/Jiankui_He/status/1912055546011918766>A post on X from Jiankui He.</a>
  </figcaption>
</figure>

<p>
  I’ve been in the startup scene for a few years now, so I figured it was time I read some Girard myself rather than (1) avoiding any discussions about Girard or (2) blindly imitating how everyone else uses the word “Girardian” and hoping nobody finds out. What follows is a brief review of Girard’s 2001 book <i>I See Satan Fall Like Lightning</i> and an introduction to the ideas contained within, with the caveat that I’m not a Girard expert and I’ve only read this one book. (I’ve presented the ideas in a slightly different order than Girard does because they made more sense to me this way; apologies if this upsets any true Girardians out there!)
</p>

<br>
<div class=dinkus>* * *</div>
<br>


<p>
  <i>I See Satan Fall Like Lightning</i> opens with a discussion of the 10th Commandment:
</p>

<blockquote>
You shall not covet your neighbor's house; you shall not covet your neighbor's wife, or his male servant, or his female servant, or his ox, or his donkey, or anything that is your neighbor's. (Ex 20:17, ESV)
</blockquote>

<p>
Girard argues that the archaic word “covet” is misleading and that a better translation is simply “desire.” This commandment, to Girard, illustrates a fundamental truth of human nature—we desire what others have, not out of an intrinsic need but simply because others have them. This is why the 10th Commandment begins by enumerating a list of objects but closes with a prohibition on desiring “anything that is your neighbor’s.” The neighbor is the source of the desire, not the object.
</p>

<p>
The essential and distinguishing characteristic of humans, in Girard’s framing, is the ability to have flexible and changing desires. Animals have static desires—food, sex, and so on—but humans have the capacity for “mimetic desire,” or learning to copy another’s desire. This is both good and bad:
</p>

<blockquote>
Once their natural needs are satisfied, humans desire intensely, but they don’t know exactly what they desire, for no instinct guides them. We do not each have our own desire, one really our own… Mimetic desire enables us to escape from the animal realm. It is responsible for the best and the worst in us, for what lowers us below the animal level as well as what elevates us above it. Our unending discords are the ransom of our freedom. (pp. 15–16)
</blockquote>

<p>
Mimetic desire leads us to copy others’ desires: we see that our friend has a house and we learn that this house is desirable. Mimetic desire, however, leads us into conflict with our neighbor. The house that we desire is the one that someone already has; the partner we desire is someone else’s. 
</p>

<p>
  To make matters worse, our own desire for what our neighbor validates and intensifies their own desire through the same mechanism, leading to a cycle of “mimetic escalation” in which the conflict between two parties increases without end. The essential sameness of the two parties makes violence inescapable. The Montagues and Capulets are two noble houses “both alike in dignity” (<i>Romeo and Juliet</i>, prologue)—their similarity makes them mimetic doubles, doomed to destruction. 
</p>

<figure>
  <img class=centered-img src="../img/20250724_agincourt.png" style="width:650px;" />
  <figcaption>
    <a href=https://commons.wikimedia.org/wiki/File:Schlacht_von_Azincourt.jpg>Artistic depiction of the Battle of Agincourt.</a>
  </figcaption>
</figure>

<p>
While the above discussion focuses only on two parties, Girard then extends the logic to whole communities, arguing that unchecked mimetic desire would lead to the total destruction of society. To prevent this, something surprising happens: the undirected violence that humans feel towards their neighbors is reoriented onto a single individual, who is then brutally murdered in a collective ritual that cleanses the society of its mutual anger and restores order. Here’s Girard again: 
</p>

<blockquote>
The condensation of all the separated scandals into a single scandal is the paroxysm of a process that begins with mimetic desire and its rivalries. These rivalries, as they multiply, create a mimetic crisis, the war of <i>all against all</i>. The resulting violence of all against all would finally annihilate the community if it were not transformed, in the end, into a war of <i>all against one</i>, thanks to which the unity of the community is reestablished. (p. 24, emphasis original)
</blockquote>

<p>
(Note that the word “scandal” here is Girard’s transliteration of the Greek σκάνδαλον, meaning “something that causes one to sin” and not the contemporary and more frivolous meaning of the word.)
</p>

<p>
This process is called the “single-victim mechanism”; the victim is chosen more or less at random as a <a href=https://en.wikipedia.org/wiki/Focal_point_(game_theory)>Schelling point</a> for society’s anger and frustration, not because of any actual guilt. Girard recognizes that this process seems foreign to modern audiences and mounts a vigorous historical defense of its validity. He recounts an episode from Philostratus’s <i>Life of Apollonius of Tyana</i> (<a href=https://www.theoi.com/Phasma/PhasmaEphesios.html>link</a>) in which Apollonius ends a plague in Ephesus by convincing the crowd to stone a beggar. Philostratus explains this by saying that the beggar was actually a demon in disguise, but Girard argues that the collective violence cures the Ephesians from social disorder, and that the victim is retrospectively demonized (literally) as a way for the Ephesians to justify their actions.
</p>

<p>
(How does ending social disorder cure a plague? Girard argues that our use of “plague” to specifically mean an outbreak of infectious disease is anachronistic, and that ancient writers didn’t differentiate between biological and social contagion—in this case, the plague must have been one of social disorder, not a literal viral or bacterial outbreak.)
</p>

<p>
While we no longer openly kill outsiders to battle plagues, Girard argues that the violent impulses of the single-victim mechanism are still visible in modern societies: he uses the examples of lynch mobs, the Dreyfus affair, witch hunts, and violence against “Jews, lepers, foreigners, the disabled, the marginal people of every kind” (p. 72) to illustrate our propensity towards collective violence. Racism, sexism, ableism, and religious persecution are all different aspects of what Girard argues is a fundamental urge towards collective majority violence.
</p>

<p>
  In the past, ritual human sacrifice is well-documented: see <i>inter alia</i> the Athenian <a href=https://en.wikipedia.org/wiki/Pharmakos><i>pharmakoi</i></a>, the Mayan custom of throwing victims into <a href="https://en.wikipedia.org/wiki/Sacred_Cenote#Human_sacrifice"><i>cenotes</i></a> to drown, and the sinister rites of ancient Celts. While modern anthropologists are typically perplexed by these rituals, Girard argues that they ought not to be downplayed. The development of the single-victim mechanism across so many cultures is not an accident. Instead, this mechanism is the foundation of all human culture, because it replaces primitive violence (which leads to anarchy) with ritual violence and allows society to persist and create institutions. 
</p>

<p>
  The single-victim mechanism is necessary cultural technology, which is why so many cultures share the myth of a “founding murder” (Abel, Remus, <a href=https://en.wikipedia.org/wiki/En%C5%ABma_Eli%C5%A1>Apsu</a>, <a href=https://en.wikipedia.org/wiki/Dumuzid>Tammuz</a>, and so on). But the founding murder doesn’t just herald the creation of human society. The collective murder of the victim does so much to restore harmony to the community that the transformation seems miraculous. The people, having witnessed a miracle, decide that the one they killed must now be divine:
</p>

<blockquote>
Unanimous violence has reconciled the community and the reconciling power is attributed to the victim, who is already “guilty,” already “responsible” for the crisis. The victim is thus transfigured twice: the first time in a negative, evil fashion; the second time in a positive, beneficial fashion. Everyone thought that this victim had perished, but it turns out he or she must be alive since this very one reconstructs the community immediately after destroying it. He or she is clearly immortal and thus divine. (pp. 65–66)
</blockquote>

<p>
  This might seem bizarre—it did to me when I read it—but many other writers have discussed the peculiar motif of the <a href=https://en.wikipedia.org/wiki/Dying-and-rising_god>“dying then rising”</a> deity. A more historical example is Caesar, who is first killed and then deified as the founder of the Roman Empire, with his murder being the central event in the advent of the new age.
</p>

<figure>
  <img class=centered-img src="../img/20250724_apotheosis.png" style="width:450px;" />
  <figcaption>
    <i>The Apotheosis of Hercules</i>, Noël Coypel (c. 1700)
  </figcaption>
</figure>

<p>
Pagan myths and deities, Girard argues, are the echoes of a shadowy pre-Christian era of violent catharsis, a time in which “the strong do what they can and the weak suffer what they must” (Thucydides). Behind the sanitized modern stories of Mount Olympus and Valhalla—dark even in their original, non-Percy-Jackson retellings—are sinister records of outcasts who were first killed and then deified.
</p>

<p>
Girard argues that the Bible stands in opposition to this mimetic cycle. Collective violence threatens figures like Joseph, Job, and John the Baptist, but the Biblical narrative both defends their innocence and maintains their humanity. The Psalms repeatedly defend the innocence of the Psalmist against the unjust accusation of crowds (cf. Psalms 22, 35, 69). Uniquely among ancient documents, the Bible takes the side of the victim and not the crowd.
</p>

<p>
In the Gospels, Jesus opposes the single-victim mechanism. In the story of the woman convicted of adultery, he tells the accusers “Let him who is without sin among you be the first to throw a stone at her” (John 8:7, ESV). This is the exact opposite of Apollonius of Tyana:
</p>

<blockquote>
Saving the adulterous woman from being stoned, as Jesus does, means that he prevents the violent contagion from getting started. Another contagion in the reverse direction is set off, however, a contagion of nonviolence. From the moment the first individual gives up stoning the adulterous woman, he becomes a model who is imitated more and more until finally all the group, guided by Jesus, abandons its plan to stone the woman. (p. 57)
</blockquote>

<p>
  (Unfortunately, it’s unlikely that the story of the woman accused of adultery is in the original text of John. <a href=https://en.wikipedia.org/wiki/Jesus_and_the_woman_taken_in_adultery#Manuscripts>The oldest New Testament sources we have, like Codex Vaticanus, Codex Sinaiticus, and various papyri, lack this story.</a>)
</p>

<p>
Jesus becomes the target of mimetic violence himself, of course, culminating in his crucifixion and death at Calvary. But Girard argues that what seems like the ultimate victory of mimetic violence—the brutal murder of the person who sought to stop it—is actually its moment of defeat, what he calls the “triumph of the cross” in a paraphrase of Colossians 2. He writes:
</p>

<blockquote>
The principle of illusion or victim mechanism cannot appear in broad daylight without losing its structuring power. In order to be effective, it demands the ignorance of persecutors who “do not know what they are doing.” It demands the darkness of Satan to function adequately. (pp. 147–148)
</blockquote>

<p>
Unlike in previous cases, where the actions of the crowd were unanimous and the victim perished alone, a minority remains to proclaim the innocence of Jesus. While the majority of the crowd doesn’t follow them, this is enough—the collective violence of the crowd can only function properly as long as the crowd remains ignorant of what they’re doing. Clearly explaining the victim mechanism also serves to destroy it, and so the victim mechanism is ended by the testimony of the early Christians, a stone “cut out by no human hand” that grows to fill the whole world and destroys the opposing kingdoms (Daniel 2:34–35, ESV). 
</p>

<p>
  The Gospel narrative exposes the workings of the victim mechanism and defeats it. While Satan thinks he’s winning by killing Jesus, Jesus’ death will make the single-victim mechanism clear and destroy the ignorance in which the Prince of Darkness must work. Girard explains this as the theological idea of “Satan duped by the cross” (which modern listeners may recognize from <i>The Lion, The Witch, and the Wardrobe</i>):
</p>

<blockquote>
God in his wisdom had foreseen since the beginning that the victim mechanism would be reversed like a glove, exposed, placed in the open, stripped naked, and dismantled in the Gospel Passion texts… In triggering the victim mechanism against Jesus, Satan believed he was protecting his kingdom, defending his possession, not realizing that, in fact, he was doing the very opposite. (p. 151)
</blockquote>

<p>
While the story of Jesus’s resurrection might seem to have many parallels with the divinization of sacrificial victims, Girard says that these are “externally similar but radically opposed” (p. 131). Indeed, he argues that the Gospel writers intentionally highlighted similarities between the false resurrection of collective violence and the true resurrection of Jesus: Mark 6:16 shows Herod anxious that John the Baptist, whom he killed, has come back to life, while Luke 23:12 shows how Jesus’ death makes Herod and Pilate friends in the same way the victim mechanism always does. In Girard’s words, “the two writers emphasize these resemblances in order to show the points where the satanic imitations of the truth are most impressive and yet ineffectual” (p. 135). The divinization of victims is pathetic and flimsy next to the true resurrection.
</p>

<figure>
  <img class=centered-img src="../img/20250724_crucifixion.jpg" style="width:400px;" />
  <figcaption>
    <i>Crucifixion</i>, Bartolomeo Bulgarini (c. 1330)
  </figcaption>
</figure>


<p>
In the new Christian age, Jesus invites us to avoid mimetic contagion not by attempting to avoid having desires in a Buddhist way—to do so is to deny our nature as humans—but by presenting himself as the model for humans to imitate. Only Jesus, the Bible argues, is a fitting template for human desire: hence Paul’s command to “imitate me as I imitate Christ” (1 Cor 11:1), and the consistent call throughout Scripture to love what God loves and hate what God hates (cf. Ps. 139). 
</p>

<p>
Girard ends his book with a discussion of modernity and our culture’s now-total embrace of victims. Girard’s writing is powerful, concise, and difficult to summarize in this section, so I’ll quote from the final pages at length.
</p>

<blockquote>
All through the twentieth century, the most powerful mimetic force was never Nazism and related ideologies, all those that openly opposed the concern for victims and that readily acknowledged its Judeo-Christian origin. The most powerful anti-Christian movement is the one that takes over and “radicalizes” the concern for victims in order to paganize it. The powers and principalities want to be “revolutionary” now, and they reproach Christianity for not defending victims with enough ardor. In Christian history they see nothing but persecutions, acts of oppression, inquisitions.
<br><br>
This other totalitarianism presents itself as the liberator of humanity. In trying to usurp the place of Christ, the powers imitate him in the way a mimetic rival imitates his model in order to defeat him. They denounce the Christian concern for victims as hypocritical and a pale imitation of the authentic crusade against oppression and persecution for which they would carry the banner themselves.
<br><br>
In the symbolic language of the New Testament, we would say that in our world Satan, trying to make a new start and gain new triumphs, borrows the language of victims. Satan imitates Christ better and better and pretends to surpass him. This imitation by the usurper has long been present in the Christianized world, but it has increased enormously in our time. The New Testament evokes this process in the language of the <i>Antichrist</i>… 
<br><br>
The Antichrist boasts of bringing to human beings the peace and tolerance that Christianity promised but has failed to deliver. Actually, what the radicalization of contemporary victimology produces is a return to all sorts of pagan practices: abortion, euthanasia, sexual undifferentiation, Roman circus games galore but without real victims, etc.
<br><br>
Neo-paganism would like to turn the Ten Commandments and all of Judeo-Christian morality into some alleged intolerable violence, and indeed its primary objective is their complete abolition. (pp. 180–181, emphasis original)
</blockquote>

<p>
Satan, whose previous work through the victim mechanism was defeated by Christianity, now seeks to imitate God’s people and use their own arguments against them. Although Christians invented the idea of having sympathy for the victim (in Girard’s view), Satan now argues that Christianity itself is intrinsically a form of violence against victims, with the only solution being the “complete abolition” of Christian morals. Girard alleges that this is bad, and if implemented would lead to the pagan anarchy of long ago. 
</p>

<br>
<div class=dinkus>* * *</div>
<br>

<p>
Girard’s style is hard to pin down: he bounces between anthropology, close reading of ancient texts, history, and theology without breaking stride. I enjoy reading his writing a lot, but sometimes I wish there would be more sources: he alludes to a fascinating series of historical interviews with tribes that practiced human sacrifice, for instance, but doesn’t leave a reference to the original interviews. 
</p>

<p>
  As a work of theology, <i>I See Satan Fall Like Lightning</i> is interesting but peculiar. It’s not clear to me how interested Girard is in orthodox Christian thought. He alternates between referring to Satan as a person and an abstract concept, for instance, and uses few ideas that would be familiar to students of mainstream systematic theology. This isn’t necessarily wrong, but leaves me with a lot of open questions: what does Girard make of the sacrifice of Isaac, or the concept of sanctification, or the role of faith in all this? These might be answered in his other writings, but they weren’t answered here.
</p>

<p>
  As a work of history, <i>I See Satan Fall Like Lightning</i> is downright bizarre. The book’s literal claim—that all non-Christian “gods” are deified victims of ritual mass murder—is hard for me to accept at face value. That being said, <a href=https://corinwagen.github.io/public/blog/20250709_montaillou.html>it’s hard enough to reason about the recent past</a>, let alone ancient pre-history. Maybe he’s right about all this? Evidence feels scarce, though, and <i>I See Satan Fall Like Lightning</i> hardly conducts a careful meta-analysis of all available ancient myths. 
</p>

<p>
  Perhaps the most similar work to Girard’s in scope and ambition is Julian Jaynes’s <i>The Origin of Consciousness in the Breakdown of the Bicameral Mind</i> (<a href=https://en.wikipedia.org/wiki/The_Origin_of_Consciousness_in_the_Breakdown_of_the_Bicameral_Mind>Wikipedia</a>, <a href=https://slatestarcodex.com/2020/06/01/book-review-origin-of-consciousness-in-the-breakdown-of-the-bicameral-mind/>Slate Star Codex</a>).<sup>2</sup> Jaynes argues that ancient people didn’t actually have theory of mind or a concept of the self: instead, they personified their internal monologue and viewed it as the voice of the gods. We usually don’t notice this when we read ancient texts, because we subconsciously assume that they were similar to us. But, to quote Scott’s review:
</p>
  
<blockquote>
Every ancient text is in complete agreement that everyone in society heard the gods’ voices very often and usually based decisions off of them. Jaynes is just the only guy who takes this seriously.
</blockquote>

<p>
Much like Jaynes, Girard takes a surprising historical observation—the ubiquity of human sacrifice and the fact that ancient people saw this as essential to the health of their society—and takes it seriously, building an entire argument about how ritual human sacrifice is the original cultural technology and the root of all civilization. While I’m not fully convinced, the intellectual commitment is admirable. 
</p>

<p>
  Most bizarre of all, though, is the fact that these esoteric ideas have become a mainstream part of “Grey Tribe” thought. If I’d read this book in a vacuum, I wouldn’t expect that any of the ideas would have achieved much popularity—but in today’s world, describing things as “Girardian” or “mimetic” is <i>de rigueur</i> for the aspiring thought leader. 
</p>

<p>
  This observation itself is perhaps the best testimony to the strength of Girard’s ideas. What force other than mimetic rivalry could be strong enough to convince thousands of venture capitalists, each attempting to craft a contrarian high-conviction persona, to all reference the same Christian philosophical anthropologist?
</p>

<figure>
  <img class=centered-img src="../img/20250724_huber.png" style="width:450px;" />
  <figcaption>
    <a href=https://x.com/TobiasAHuber/status/1697221185065406775>A post on X from Tobias Huber.</a>
  </figcaption>
</figure>

<i>Thanks to my wife and Ari Wagen for reading drafts of this piece, and for Micah from church for lending me a copy of this book.</i>

<h3>Footnotes</h3>
<ol>
<li>
    I took a stab at discussing some Girard ideas <a href=https://corinwagen.github.io/public/blog/20230228_gilliam_and_girard.html>previously on the blog</a>, although I did actually read the essay which I discuss.
</li>
<li>
  Full transparency: I’ve just read the SSC book review and not (yet) the full book, thus committing the very sin which I accuse others of committing above! "Let he who is without sin cast the first stone" &amp;c.
</li>
</ol>
</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20250721_external_talk.html'>How To Give An External Research Talk</a></h2><i>July 21, 2025</i>
<figure>
  <img class=centered-img src="../img/20250721_mars_hill.jpg" style="width:500px;" />
</figure>

<p>
  <em>(This post is copied from some notes I gave to our summer interns at Rowan almost without modification. Hopefully people outside Rowan find this useful too!)</em>
</p>

<p>
This is a brief and opinionated guide on how to give a research talk to an external audience. Some initial points of clarification—this guide is for a research talk, not a sales call or a VC pitch. Research talks have their own culture and norms; treating a research talk as a sales call is likely to backfire disastrously. 
</p>

<p>
When is a research talk appropriate? Generally, if you’re talking to scientists, you should view your talk as a research talk, unless specifically advertised otherwise. 
</p>

<p>
This advice is not directly applicable for talks to internal audiences; collaborators need much less context than external audiences and you can streamline your talk accordingly. (Note that “external” and “internal” here refer to projects, not corporations—a talk to a different division of your company is “external” to the project even if you technically have the same employer.)
</p>

<h2>Goal</h2>

<p>
The goal of an external research talk is to teach the audience something. This is generally underappreciated. Many people act as if the goal of the talk is to show that they’re smart, or to show how impressive their research is, or to dump all the data from a given paper onto slides. All of these lead to talks that are mediocre at best and barbarous at worst. 
</p>

<p>
If you learn something from a talk, it’s a good talk. This is also nice because it’s easy to learn something; even bad results can teach you something. For talks in different fields, I often learn more from the introduction to a talk than from the actual results section (which goes over my head).
</p>

<h2>Audience</h2>

<p>
In any given talk, there might be several categories of people.
</p>

<ul>
  <li>
    <b>People following the field who like your work.</b> They will have already read your papers and are excited to see you speak. You should include extra details that aren’t in the paper for them.
  </li>
  <li>
    <b>People following the field who dislike your work.</b> These people might ask pushy questions or challenge your interpretations. Don’t address the talk to them, but keep some defensive backup slides just in case. (The best way to address an aggressive question is to present a nice backup slide which shows you’ve already thought deeply about the question.)
  </li>
  <li>
    <b>People adjacent to the field who don’t really know your work.</b> For Rowan, this might be a computational chemist who’s never used a neural network potential but who’s vaguely curious, or an ML researcher who’s curious about how people use deep learning in chemistry. This is usually the bulk of any given audience; your talk should be aimed at these people.
  </li>
  <li>
    <b>People who are just clueless.</b> Every talk has them; maybe they were told to go by their boss, or they misremembered which seminar this was. Ideally you can teach them something too, if they bother to pay attention, but the talk isn’t for them.
  </li>
</ul>

<p>
A perfect talk has something for everyone; you can give the fans something they didn’t read in the paper, mollify the critics, teach most listeners something new, and maybe even interest the clueless folks.
</p>

<h2>Rough Structure</h2>

<ul>
  <li>
  <b>Background.</b> What is the problem and why should the audience care about it?
  </li>
  <li>
    <b>History.</b> What has been done before?
  </li>
  <li>
    <b>Idea.</b> What was your idea?
  </li>
  <li>
    <b>Implementation.</b> What did you do?
  </li>
  <li>
    <b>Results.</b> How did the idea turn out?
  </li>
  <li>
    <b>Discussion</b>. What can the audience learn from this?
  </li>
  <li>
    <b>Future</b>. What’s next?
  </li>
  <li>
    <b>Q&amp;A.</b>
  </li>
</ul>

<p>
My contrarian take is that the background/history should comprise 30–40% of the talk. Most people have less context for your work than you expect; “context is that which is scarce.” It’s almost always worth spending more time explaining why what you’re doing is important, what other people have done, and how people in your field think about problems. 
</p>

<p>
Paradoxically, the longer you spend on background, the more impactful your results might be. You’re both building tension, as the audience wonders when you’ll get to your research, and you’re positioning your research such that when you share your actual idea the audience will be maximally excited. (I always picture this like <a href="https://www.youtube.com/watch?v=UkkF6Zz67TE">an old-school samurai duel</a>; the longer you wait before you “strike” with your results, the better.)
</p>

<p>
Many scientists overemphasize discussing their implementation and results. These topics are always the focus of the actual work, because they take the bulk of the time, and papers focus on these too since they require the most details and associated data. But talks that just explain mathematics, statistics, or data cleaning in detail are usually boring or painful to listen to—just because you suffered through the details of this process doesn’t mean the audience needs to suffer too.
</p>
 
<p>
(Paradoxically, the fact that papers focus on implementation/results means that your talk is free to deemphasize them. People who are following the field may have already read your paper; people who aren’t following the field probably won’t understand the methodology or detailed results anyway. )
</p>

<p>
One exception is if there’s some personal or non-obvious story about implementation and results—if you wasted time on the wrong architecture or had some interesting realization that led to a breakthrough, these are great to include. I’ve often gone to talks just so I can hear any narrative details that aren’t “neat” enough to be in the paper.
</p>

<p>
The ending discussion can vary a lot from talk to talk, but I think it’s worth stating clearly what you think the conclusions should be from your work. What should someone in the field take away? What should someone in an adjacent field take away? What do you predict the future of this area of research will be?
</p>

<p>
  Here's the last slide from a talk I gave at MSU in February:
</p>

<figure>
  <img class=centered-img src="../img/20250721_msu_slide.png" style="width:650px;" />
</figure>

<p>
  It’s always good to save at least 10 minutes within the allotted time for Q&amp;A, and to leave time after the talk for additional questions. 
</p>

<h2>Slides</h2>

<p>
Different people and fields have different customs here; there’s no hard-and-fast rule. I rarely make new figures for talks, because it takes forever—I’ll instead take images from existing papers and put the citations at the bottom.
</p>

<p>
A few disjointed thoughts:
</p>

<ul>
<li>
  Animations are good, but only the “appear” animation. For complex slides, it’s good to be able to add each component one-at-a-time; otherwise viewers will get distracted trying to figure out what’s next. Anything fancier than simply making something appear is bad, though.
</li>
<li>
  Slide numbers make Q&amp;A much simpler, and there’s a way to do them automatically in both Powerpoint and Google Slides.
</li>
<li>
  Large amounts of text can be distracting, but are sometimes fine. I’ll often screenshot a paragraph from a previous paper and then read a (highlighted) key sentence out loud. You probably shouldn’t have lots of original text on the slide.
</li>
<li>
  Similarly, highly detailed and complex slides are bad unless the complexity of the slide is the point. Sometimes you can put up a big architecture diagram and say something pithy like “and then we did a lot of optimization, which I’m not going to get into here but am happy to discuss one-on-one later,” and then move to the next slide. This is (in my opinion) a nice way to allude to underlying complexity without getting bogged down.
</li>
<li>
  To a first approximation the title of the slide should be a simple, declarative statement which summarizes the slide. This helps people to focus on the key ideas, even if they get distracted checking their phone.
</li>
<li>
  If you’re presenting to organic chemists, it’s helpful to put chemical structures on almost every slide.
</li>
</ul>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20250709_montaillou.html'>Book Review: Montaillou</a></h2><i>July 9, 2025</i>
<p>
The past is powerful evidence for arguments about the present. Since the time of Livy and Tacitus, it’s been common to cite history to advance some ideological, cultural, or political idea. While there’s nothing wrong with this in principle, these lines of discourse often break down because (1) people know very little history and (2) what little history they do know is usually wrong. 
</p>

<p>
  Popular understanding of history is shaped mostly by popular culture: books, movies, and video games. These sources aren’t intrinsically bad—I’ll never remember early modern European states as well as my friend who played hundreds of hours of <i>Europa Universalis IV</i> in high school. But the overall effect of a history education dominated by <i>Gladiator</i>, <i>300</i>, and <i>Ben-Hur</i> is to give people a weird and distorted view of the past,<sup>1</sup> and one inchoate enough to be shaped into almost any argument about the present.
</p>

<p>
If we want to build up a more accurate view of what it was like to live in the past, we want to start with the most fundamental questions: how did people live? How did they spend their time? What did they do for work and for leisure? What did they worry about? Unfortunately, these questions are almost always unanswerable. Most historical documents don’t touch on the daily life of average people, focusing instead on chronicling noble deeds, recording economic transactions, and so on. 
</p>

<p>
But exceptions can be found. The village of Montaillou is a small, mountainous village of about 250 inhabitants in the French Pyrenees (in Occitania, what was then the Duchy of Foix and is today the department of Ariège). Montaillou was remote and unexceptional in almost every way, making it exactly the sort of place which we’d never expect to see in historical documents—except that by 1300 it was one of the last strongholds of Catharism, a Christian heresy which had been almost completely eliminated by the Albigensian Crusade in the 1210s. 
</p>

<p>
This is typical of historical mountain societies. In his landmark work <i>The Mediterranean and the Mediterranean World in the Age of Philip II</i>, Fernand Braudel writes (pp. 38–39): 
</p>

<blockquote>
  There can be no doubt that the lowland, urban civilization penetrated to the highland world very imperfectly and at a very slow rate… for the simple reason that mountains are mountains: that is, primarily an obstacle, and therefore also a refuge, a land of the free. For there men can live out of reach of the pressures and tyrannies of civilization: its social and political order, its monetary economy.
</blockquote>

<p>
  The Cathars who had come to the mountains to flee persecution were dualist Gnostics who believed in the reincarnation of the soul. Their clerics and leaders, called goodmen (<i>bonhommes</i>) or <i>parfaits</i>, were celibate and refused to eat meat or drink wine. Ordinary Cathar followers didn’t hold themselves to this standard until their deathbed, when they would convert to Catharism in a ritual called the <i>consolamentum</i> and then completely fast until dying of hunger (called the <i>endura</i>). Cathars rejected the sacraments, mocked the priests and rituals of the Church, and saw themselves as the true worshipers of the Christian God.
</p>

<p>
  Following the Albigensian Crusade, Montaillou and other rural towns became a refuge for Catharism. This eventually drew the attention of the French Inquisition in the person of Jacques Fournier, bishop of Pamiers. In 1320, Fornier arrested a large percentage of the population of Montaillou and interrogated them at length, recording “substantial and very detailed evidence” (xiv) about their lives. During his tenure at Pamiers, Fournier’s inquisition court investigated 578 people over 370 different days, with scribes and notaries keeping a detailed record of all proceedings in what is now known as the Fournier Register. This extraordinary document might have been lost to history except for the fact that Fournier became <a href=https://en.wikipedia.org/wiki/Pope_Benedict_XII>Pope Benedict XII</a> in 1334 and the Fournier Register was brought to the Vatican Library. 
</p>

<p>
  The Fournier Register was revisited by Annales historian Emmanuel Le Roy Ladurie. His 1975 work <i>Montaillou, village occitan de 1294 à 1324</i> uses the details contained in the Register to reconstruct the world of Montaillou: who the people were, what they thought about, and how they lived. I originally read this book right before starting college and liked it a lot. Recently, I’ve found myself thinking back to Montaillou in everyday discussions about history and decided to read Le Roy Ladurie’s book again. 
</p>

<p>
In this post, I hope to give a taste of the world of Montaillou, and how surprisingly normal (or abnormal) aspects of this world can seem to modern sensibilities. I’m focusing on the questions that interested me the most in this reading, and have omitted a lot of interesting characters and life histories for the sake of space and focus. If you find this review interesting, you should certainly pick up the book yourself—I’ve indicated page numbers in <a href=https://www.amazon.com/Montaillou-Promised-Emmanuel-Roy-Ladurie/dp/0807615986>the 30th anniversary edition</a> for easy reference.
</p>

<h2>Setting</h2>

<p>
Montaillou was (and is) a small village on the French side of the Pyrenees, at an elevation of approximately 4500 feet. In a physical and economic sense, Montaillou was incredibly isolated. There was essentially no non-foot traffic in or out of the village, so goods were carried by hand or with a mule. Montaillou had no blacksmith or tailor, and iron tools were rare (7). Montaillou was too small to have its own mill, so villagers would take wheat by mule to the larger town of Ax-les-Thermes, grind it at the mill, and return with flour, about 10 miles by Google Maps (9). 
</p>

<p>
  Here's a picture of modern Montaillou from Wikipedia. The ruins of medieval Montaillou are visible at the top of the hill, and the snow-capped Pyrenees are visible some 20 miles to the south.
</p>

<figure>
  <img class=centered-img src="../img/20250709_montaillou.jpg" style="width:700px;" />
  <figcaption>Montaillou in April 2005. <a href=https://commons.wikimedia.org/wiki/File:Montaillou_28-04-05_8.jpg>See Wikimedia for higher resolution.</a></figcaption>
</figure>


<p>
The bulk of calories came from bread (made from wheat or millet), and cheese was the primary protein source (8–9). Other documented animal foods include mutton, bacon, goat’s liver, eggs, and trout (9, 82, 83, 124). Cabbages, leeks, broad beans, and turnips were the most common vegetables (9). Most people in Montaillou farmed and raised animals: pigs, cows, sheep, chickens, geese, and so on. Almost everyone kept sheep, but there were some skilled itinerant “professional” shepherds who travelled across the Pyrenees living in the mountains and supervising large herds (69–135), stopping back home from season to season.
</p>

<p>
Apart from the coinage that they used, the people of Montaillou were not “French” in any meaningful sense. They spoke a dialect of Occitanian that was distinct to their region, “about a thousand people at the most” (286). When forced to flee religious persecution, villagers went not to other regions of France but to Catalonia, Lombardy, Sicily, or Valencia (286). They almost always married within their village; in the cases where someone from Montaillou married someone from the outside, it was almost always from a neighboring village (183). Thus the world of Montaillou was, in a personal sense, very small indeed.
</p>


<h2>Housing and Personal Space</h2>

<p>
  The house (<i>domus</i> in Latin, <i>ostal</i> in Occitan) was the fundamental physical and social unit of Montaillou. Physically, the kitchen was the central room of the house, and perhaps the only one built of stone (39). The hearth and cooking utensils were in the middle of the kitchen, hams hung from the roof, and a table and chairs were off to the side (37–38). A cellar was often adjacent to the kitchen (38).
</p>

<p>
Personal space was not as scarce as people sometimes imagine in medieval times. Most rooms had only one or two people, and people had separate beds (38–39). Children and adults slept in separate rooms (39). Most houses only had one story, but richer villagers might have two-story houses (39). Animals typically slept in the house at night, albeit in separate rooms, and used the same door as people; sick people were sometimes put near animals to keep them warm at night. Only relatively wealthy farms had separate stables, pigsties, and sheep-pens (40). 
</p>

<p>
  The intellectual and social life of Montaillou revolved around the <i>domus</i>, “a unifying concept in social, family, and cultural life” (25). When villagers discussed Catharism and Catholicism, they identified beliefs not with individuals but with houses (28). To be the head of the house was a significant position of authority; to have one’s house confiscated or destroyed was cataclysmic (35–37). 
</p>

<figure>
  <img class=centered-img src="../img/20250709_feb.png" style="width:400px;" />
  <figcaption> Detail of the February scene from the <i>Très Riches Heures du Duc de Berry</i> (c. 1415)</figcaption>
</figure>


<h2>Family</h2>

<p>
It’s become somewhat popular in recent years to argue against the primacy of the nuclear family. In his 2020 article “<a href=https://www.theatlantic.com/magazine/archive/2020/03/the-nuclear-family-was-a-mistake/605536/>The Nuclear Family Was a Mistake</a>”, David Brooks argues that “big, interconnected, and extended families” are the historical norm and a healthier & more natural way to live. I’ve thought about this essay and argued about it with friends many times over the past few years; in fact, these arguments were a large part of why I originally wanted to reread Montaillou. 
</p>

<p>
I expected the history of Montaillou to support Brooks’s position that extended families were more normal than nuclear families in medieval societies, but it didn’t. The vast majority of houses held nuclear families, or nuclear-ish families where an uncle or grandmother lived with the core family unit. Several examples of more extended families are documented, but they are “very rare cases” and usually unstable (48). As a rule, there was only one married couple per house and the house organized itself around this couple. 
</p>

<p>
Montaillou was largely patriarchal, but not entirely so. There were maternal houses where the sons took their mother’s name and son-in-laws took their wife’s name (34). Nor was primogeniture absolute. Fathers generally determined who inherited the house, but the inheritor did not have to be the firstborn, and the other sons would receive a smaller portion called a fratrisia (36). Both these facts surprised me. 
</p>

<p>
Marriage was typically arranged by the family and “involved much more than a mere agreement between two individuals” (180), with numerous relatives often involved. Dowries were substantial enough that families worried that marrying their daughters might bring economic ruin upon their houses, but remained the distinct property of the wife after marriage. If the husband died first, the widow retained her dowry separately from whomever might inherit the rest of the possessions (35–36).
</p>

<p>
Widows were common because women were typically married young, between the ages of 15 and 20, while men typically waited until after 25 to marry (190). Le Roy Ladurie writes (191): 
</p>

<blockquote>
Husbands in Montaillou were generally fully adult and they often married young innocents. The girls were beginners; the men were settling down. This difference in age in a world where people died young soon produced a crop of young widows. With one husband in the grave, women prepared to go through one or even two more marriages.
</blockquote>

<p>
While marriage for love was not the primary objective, neither was it impossible: “it was possible to love passionately within apparently rigid structures which predisposed towards and presided over the choice of a marriage partner” (187). That being said, the sources rarely speak of women’s feelings towards their husbands (189):
</p>

<blockquote>
It is probably, and sometimes provable, that the young men in love whom we find in the Register aroused similar feelings in the girls they married. But references are scarce. Rightly or wrongly, in upper Ariège the man was supposed to possess the initiative or even the monopoly in matters of love and affection, at least in the realm of courtship and marriage.
</blockquote>

<figure>
  <img class=centered-img src="../img/20250709_jul.png" style="width:400px;" />
  <figcaption> Detail of the July scene from the <i>Très Riches Heures du Duc de Berry</i> (c. 1415)</figcaption>
</figure>


<h2>Stages of Life</h2>

<p>
As might be expected, families in Montaillou were considerably larger than today. Based on data in the Register, Le Roy Ladurie estimates that there were 4.5 legitimate births per family, plus a small but non-negligible number of illegitimate births (204). For all but the wealthiest of families this was an asset: “a domus rich in children was a domus rich in manpower; in other words, rich, pure and simple” (207). Contraception was practiced, especially outside marriage, but not abortion (172–173, 209). Children were nursed for a long time, perhaps until two years old (208).
</p>

<p>
  Modern people sometimes allege that love for young children is a modern phenomenon, citing the Roman <i>paterfamilias</i> as evidence to the contrary. In Montaillou, as today, men and women loved their young children, laughing & playing games with them and weeping bitterly when they died (210–213). The mortality rate for children and adolescents is not clear from our data but “was probably high” (221). Schooling was practical, not formal—children worked with their parents, outside and inside, and were taught religion (Catholic or Cathar) by their families. Children were often put to bed early; the Register records that a six-year-old girl is put to bed before dinner is served to guests (215). 
</p>

<p>
  At the age of 12 or so, boys changed status. The word used to describe them shifts from <i>puer</i> (used from age 2 onwards) to <i>adulescens</i> or <i>juvenis</i>. As adolescents, they began to work as apprentice shepherds, were considered to have reached the age of reason, and could be arrested for heresy (215–216). At 18, men became full-fledged adults (216). I’ll quote Le Roy Ladurie directly on aging (216):
</p>

<blockquote>
When it came to old age, there was a different pattern for men and women. In their thirties, men were in their prime. In their forties, they were still strong. But after about fifty a man was old in those days, and his prestige, unlike that of an elderly woman, did not increase with time. 
</blockquote>


<h2>Friends</h2>

<p>
Domestic servants and hired shepherds were common, and servants often lived in their employers’ houses (115). Labor markets seem quite liquid in this time period—shepherds are often hired for a season and “did not feel this instability as some kind of oppression or alienation” (114). People were part of a market economy, but the 1300s had “easy norms” (124):
</p>

<blockquote>
Everyone who has studied the daily life of the people of Montaillou, whether locals or emigrants, has been struck by the relaxed rhythm of their work, whether they were shepherds, farmers, or artisans… When necessary [a shepherd] got his friends to look after his sheep for him while he went down to the neighbouring town, to take, or to collect, money. Or he might absent himself for purely personal reasons, without any problems of time-keeping or supervision, to go and visit friends, mistresses (unless they came up directly to see him in his cabane) or fellow-sponsors, friends acquired at baptisms recently or long ago…. [He] enjoyed parties and entertainment, and even just a good meal among friends.
</blockquote>


<p>
  The social divide between nobles and non-nobles in Montaillou was not vast. Le Roy Ladurie writes that “ladies and <i>châtelaines</i>, when they met with peasant women, did not hesitate to settle down for a gossip; they might even kiss and embrace” (16). This was likely less true in larger towns or cities; “the absence of strong demarcation between groups can be explained by the relative poverty of the mountain nobility” as contrasted to “the nobles of Paris or Bordeaux, with their huge manorial estates and their vineyards worth their weight in gold” (17). 
</p>

<p>
People had many close, intimate friendships outside the immediate or extended family. Groups of women socialized while fetching water, at the mill, in the kitchen, or sitting in the sun in the village square (251–254). Men met to sing, play chess, or speculate about if Heaven would run out of space for the souls of the dead (259–260). Sunday Mass was the central social event of the week, even for heretics or non-believers, but even so only about half the populace went to Mass any given week (265; 305). 
</p>

<p>
  Even in a village of a few hundred people, it was possible to keep secrets. Heretic <i>parfaits</i> snuck from house to house via secret passages (41) or disguised themselves as woodcutters to move about incognito (75–76), while nosy neighbors peeked through holes in doors or lifted up roofs (which must have been flimsy) to spy on heretical conversations (245; 256). 
</p>

<figure>
  <img class=centered-img src="../img/20250709_mar.png" style="width:400px;" />
  <figcaption> Detail of the March scene from the <i>Très Riches Heures du Duc de Berry</i> (c. 1415)</figcaption>
</figure>

<h2>Religion and Ethics</h2>

<p>
The taxes owed to the nobility were relatively light, particularly compared to the heavy taxes extracted by the Church, and the latter were hated much more than the former (20–23). It was common for people who owed the Church money (including tithes) to be excommunicated (335). The success of Catharism in Montaillou can be largely attributed to the burdensome taxation of the Church, which gave rise to strong anti-clerical feelings far in advance of any theological rationale. I was surprised to learn that indulgences were a part of Catholic religious practice even in the early 1300s, and were hated then too (334). 
</p>

<p>
Many people envision medieval Europe as a theocracy where Catholic morals reigned supreme, either for good or for ill. At least in the case of Montaillou, this wasn’t true—there were lots of mistresses, concubines, prostitution, illegitimate children, and sordid love affairs (45, 151, 169). Homosexuality is not recorded in Montaillou but is documented in the larger cities of Pamiers and Toulouse (144–149). Approximately 10% of couples in Montaillou during this time period were illicit or “living in sin,” and non-marital cohabitation was common enough that a visitor to one house was uncertain if the woman there was the man’s wife or his concubine. Le Roy Ladurie writes (169):
</p>

<blockquote>
If anyone came across a couple openly living together, the reaction was much the same as it would be today. Were they legally married or not? 
</blockquote>

<p>
  Sexual ethics aside,<sup>2</sup> crime was rare. While petty theft was not uncommon and grazing rights were always a source of conflict, Montaillou was an intimate society where “everyone knew everyone else and strangers were easy to find,” making crimes against property rather impractical (329). In cases in which a flock or house was confiscated, it was always under some legal mechanism rather than outright use of force. During the decades covered by the Fournier Register, a single murder and a handful of rapes are recorded—while this significantly exceeds the present on a per capita basis, these events were rare and shocking to the villagers.
</p>

<figure>
  <img class=centered-img src="../img/20250709_nov.png" style="width:400px;" />
  <figcaption> Detail of the November scene from the <i>Très Riches Heures du Duc de Berry</i> (c. 1415)</figcaption>
</figure>

<h2>Culture</h2>

<p>
The Fournier Register excels as a window into peasant culture in the 14th century. Peasants were “fond of abstract thought and even of philosophy and metaphysics” (232), and Le Roy Ladurie remarks on “the lack of social distance between the countryman… and the nobleman, the priest, the merchant, and the master craftsman, in a world where manual labour, especially craftsmanship, was not despised” (232). The primary social engagement was the evening meal, where groups of peasants would sit for hours at benches around the fire remembering village history, discussing the health of people and animals, arguing about the resurrection of the body, or simply gossiping (247, 250). Wine was served, but not to excess—drunkenness is only mentioned in urban contexts in the Fournier Register, and even there rarely (249). 
</p>

<p>
  Books, while rare and expensive, were important and recognized cultural objects—both Cathar <i>parfaits</i> and Catholic priests derived intellectual legitimacy from the possession of books (211, 234–236). It was rare, but not unheard of, for laymen to be able to read: Le Roy Ladurie estimates that four out of the roughly 250 inhabitants of Montaillou were literate (239). As a result most ideas were transmitted orally, and the Cathar <i>parfaits</i> were renowned for their oration and eloquence.
</p>

<p>
I was very surprised to learn that history was virtually unknown in Montaillou. Only in larger cities like Pamiers was Roman antiquity known and discussed, and there only rarely; in Montaillou, history “scarcely went back further than the previous Comte de Foix” (282). The Church filled this void, but imperfectly. Villagers knew almost nothing of Christian history besides Creation, the lives of Mary, Jesus, and the Apostles, and the coming Day of Judgement and the Resurrection (281). As Le Roy Ladurie describes it, “the people of Montaillou lived in a kind of ‘island in time,’ even more cut off from the past than from the future” (282).
</p>

<h2>Conclusion</h2>

<p>
I’ve only scratched the surface of Montaillou here. I haven’t told the story of Pierre Clergue, heretic village priest who had at least nine mistresses (and probably more) and used his brutal authority to crush village rivals; Pierre Maury, itinerant master shepherd with a love of poverty and a fatalist outlook on life; or Béatrice de Planissoles, twice-widowed noblewoman with a proclivity for dramatic love affairs with non-nobles between husbands. I feel some guilt in omitting these thrilling tales from my review, but I don’t think I can do them justice here.
</p>

<p>
What I’ve instead attempted to do here is give the flavor of medieval life as recounted by Le Roy Ladurie. Since this is a microhistory, we have to be cautious about how much we can generalize; Montaillou was different in the 14th century than in the 10th century, and would be different again by the 17th century, to say nothing of how life would be different in Frisia, Andalusia, Calabria, or outside medieval Europe. (If there’s one thing we can learn from Montaillou, it’s that history is big and strange.)
</p>

<p>
Still, I updated a number of my beliefs about the past after reading about Montaillou. Here’s a few common claims that I thought Montaillou directly addressed.
</p>

<ol>
<li>
    <b>“The nuclear family was a mistake.”</b> I discussed this claim from David Brooks above. Per his argument, Montaillou is exactly the sort of place that we might expect to show strong non-nuclear family living patterns, and yet if anything we see the exact opposite. This suggests that nuclear-family structures are more fundamental than Brooks argues (with the important caveat that this is just a single data point).
</li>
<li>
    <b>“Medieval peasants lived miserable lives of suffering, toil, and death.”</b> Strikingly false in the case of Montaillou. Mortality rates were certainly high, but even the subsistence-level farmers and shepherds documented by the Register had active, social, and joyful lives. I’m not convinced that the median person in Montaillou was less happy than the median person today; if anything, possibly the opposite.<sup>3</sup>
</li>
<li>
    <b>“Learning was forgotten in the Dark Ages.”</b> I was surprised by how true this was for Montaillou. There’s been a lot of pushback against misconceptions about the so-called “Dark Ages,” and popular conceptions about the time between the fall of the Western Roman Empire and the Renaissance are usually just wrong (cf. <a href=https://www.amazon.com/World-Late-Antiquity-150-750-Civilization/dp/0393958035>Peter Brown</a>). But the people of Montaillou were ignorant of almost all history, even just a few generations ago in their village. Maybe this was always true in rural areas, but I suspect this would have been much less true in Roman times and, again, stopped being true by the time of the Renaissance and the Reformation.
</li>
<li>
    <b>“Medieval Europe was a Catholic society where people adhered to Christian morals.”</b> I hear this a lot from more traditional Catholic friends, and this is just bonkers. Maybe Montaillou is an edge case—again, village of heretics—but Le Roy Ladurie argues that the heresy was a symptom of disrespect for the Church, not a cause. The fact that 10% of couples were openly unmarried and cohabitating defied all my intuition about medieval Europe.
</li>
</ol>

<p>
I really enjoyed this microhistory and would love to read different accounts of everyday life in medieval Europe—if you have any recommendations, please let me know!
</p>

<br />
<br /> 

<h3>Footnotes</h3>
<ol>
<li>
  As an aside, I’m a big fan of Bret Devereaux’s writing. He does a fantastic job of debunking myths about history, like <a href=https://acoup.blog/2019/05/28/new-acquisitions-not-how-it-was-game-of-thrones-and-the-middle-ages-part-i/>this series on <i>Game of Thrones</i></a> or <a href=https://acoup.blog/category/collections/this-isnt-sparta/>this series on Sparta</a>, and also does a lot of interesting long-form about pre-modern agriculture, textiles, logistics, and so on.
</li>
<li>
  This moral laxity was gone by the 17th century. The Reformation and Counter-Reformation gave rise to an ocean of fierce debates about theology and ethics and created a society which, compared to Montaillou, was much more concerned about matters of orthodoxy and orthopraxy and much less tolerant of any deviancy. Massachusetts Puritanism can be understood as a facet of this transformation, as can the <a href=https://en.wikipedia.org/wiki/Reformation_of_Manners>Reformation of Manners</a>. This change is noted by Le Roy Ladurie, but my interpretation here comes mainly from Diarmid MacCulloch’s book <i>The Reformation</i>.
</li>
<li>
    It’s worth noting that the feudal order as experienced in Montaillou was pretty lax—less rural areas like those around Paris were probably closer to popular depictions of feudal serfdom. I’m not sure which is more “typical” of feudalism, or if that question is even coherent; feudalism is a broad and often misunderstood concept, see <a href=https://www.amazon.com/Feudalism-F-L-Ganshof/dp/058248216X>Ganshof’s book</a> for a good overview.
</li>
</ol>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20250702_workflows.html'>Workflows Are the New Models</a></h2><i>July 2, 2025</i><br />
<br />
<a href="https://x.com/CorinWagen/status/1939695363427893471"><em>Expanded from a post on X</em></a><em>, which I felt didn’t do a good job expressing all of what I meant.</em>

<p>
  The past few years of “AI for life science” has been all about the models: AlphaFold&nbsp;3, neural-network potentials, protein language models, binder generation, docking, co-folding, ADME/tox prediction, and so on.  
  But <a href="https://www.chaidiscovery.com/news/introducing-chai-2">Chai-2</a> (and lots of related work) shows us that the vibes are shifting.  
  Models themselves are becoming just a building block; the real breakthroughs are going to happen at the workflow level, as we learn how to combine these models into robust and performant pipelines.
</p>

<p>
  Workflows are the new models.  
  To have a state-of-the-art computational stack for drug discovery (or protein engineering, or materials design, or anything else), it’s no longer enough to have just a single state-of-the-art model.  
  You need a suite of modular tools that you can combine in a way that makes sense for your task. (At Rowan, we’re seeing this happen all over the industry.)
</p>

<p>What does this mean in practice? Here are two imaginary case studies illustrating what modern computational chemistry looks like in 2025:</p>

<h3>Materials Science</h3>

<p>
  A company is developing a new inorganic photocatalyst for bulk acid–alkene coupling (following
  <a href="https://pubs.acs.org/doi/abs/10.1021/jacs.0c08688">Zhu and Nocera, 2020</a>).  
  Their workflow might look something like this:
</p>

<ul>
  <li>Agentic literature search for potential photo-active inorganic materials that seem synthesizable.</li>
  <li>A diffusion or flow-matching model for 3-D structure generation where crystallography data doesn’t exist.</li>
  <li>Rapid structural relaxation with a neural-network potential (NNP) to generate minimized structures.</li>
  <li>Adsorption-energy estimation with another NNP to see if alkene binding is feasible.</li>
  <li>HOMO–LUMO gap computation with periodic DFT to estimate photo-activity.</li>
  <li>Molecular dynamics to check the stability of the bound pose.</li>
  <li>Volcano-plot creation and final candidate scoring based on all properties.</li>
</ul>

<p>
  The entire cycle can be repeated <em>ad nauseum</em> to generate new candidates, with the focus gradually shifting from exploration to exploitation.
</p>

<h3>Drug Discovery</h3>

<p>
  A company has identified new CNS biological targets that they hope to inhibit with a small molecule.  
  Their workflow might look something like this:
</p>

<ul>
  <li>Based on a starting hit (from a DEL, or from a known binder), generate modifications automatically or by sampling from an enumerated library.</li>
  <li>Filter candidates by synthesizability, solubility, pK<sub>a</sub>, and other project-specific structural filters.</li>
  <li>Dock molecules against the target and potential anti-targets using a fast method like Vina.</li>
  <li>For hits predicted to show good selectivity, rescore with a second method (strain-corrected docking, Boltz-2, etc.).</li>
  <li>
    <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jcim.0c00057">Run a short MD simulation</a> to check the stability of the bound pose.
  </li>
  <li>
    Screen for <a href="https://rowansci.com/publications/macroscopic-pka-prediction">blood–brain-barrier permeability</a> and
    <a href="https://pubs.acs.org/doi/10.1021/acs.chemrestox.4c00015">liver toxicity</a> (e.g.).
  </li>
</ul>

<p>
  This cycle, too, can be repeated until <del>you run out of Modal credits</del> a set of promising candidates is identified for synthesis.
</p>

<br />

<p>
  Neither of these case studies is based on a particular company; instead, they’re meant to illustrate the sort of ML-native workflows we’re seeing from early adopters across the chemical sciences.  
  For simplicity, experimental integration isn’t shown here, but any sane scientist will obviously incorporate wet-lab testing as soon as possible and feed those insights back into the top of the funnel.
</p>

<p>
  In any case, the overall point is clear—no single model can by itself solve every problem, and figuring out the right way to combine a set of models is itself a non-trivial system-design problem.  
  It’s entirely possible to create a state-of-the-art workflow simply by combining “commoditized” open-source models in a new way, and so far the resultant workflows don’t seem obvious or easy to copy.  
  This defies popular intuition about what constitutes a “moat” for AI companies.
</p>

<p>
  More metaphysically, the line between workflows and models is blurring.  
  Many ML-adjacent people think of models as the active unit of science: “they have a model for X” or “we’re building a model for Y.”  
  But, as shown above, most state-of-the-art research today requires lots of individual ML models, and many “models” are already miniature workflows.  
  For instance, running a single inference call through
  <a href="https://github.com/dptech-corp/Uni-pKa">the Uni-pKa “model”</a> requires enumerating all possible microstates, performing a conformer search, and running geometry optimizations on every individual conformer—just to generate the pairwise-distance matrix used as input for the actual ML model.
</p>

<p>Why does this matter? Here are a few thoughts that I've had, after thinking about this point:</p>

<ul>
  <li>Models must be plug-and-play, interoperable, and robust—anything that can’t be integrated into higher-level workflows won’t be used.</li>
  <li>
    The best models might not be those that top isolated benchmarks; in a workflow context, speed, reliability, and uncertainty
    quantification also matter.  
    Richard Hamming’s first rule of systems engineering comes to mind: “If you optimize the components, you will probably ruin the system
    performance” (<a href="https://corinwagen.github.io/public/blog/20230516_hamming.html">see my previous book review</a>).
  </li>
  <li>
    Any thinking that depends on a sharp metaphysical difference between workflows and models is probably wrong.  
    I recently had a sales call where someone told me they weren’t interested in any workflows—they only wanted to use models.  
    I wanted to send them to
    <a href="https://slatestarcodex.com/2014/11/21/the-categories-were-made-for-man-not-man-for-the-categories/">old Slate Star Codex posts</a>,
    but (wisely?) held my tongue.
  </li>
  <li>
    Devops and good software engineering will rise in importance.  
    At Rowan, we’ve learned firsthand how hard it is to manage hundreds of thousands of workflows across a vast sea of unruly scientific dependencies.
  </li>
  <li>
    Relatedly, the amount of scientific, computational, and engineering expertise needed to run a modern computational-science program is
    rising exponentially—and shows no signs of stopping.
  </li>
</ul>

<i>Thanks to Ari Wagen for reading a draft of this post.</i>
</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20250604_good_will_hunting.html'>Teach Yourself Quantum Chemistry (For Fun And Profit)</a></h2><i>June 4, 2025</i>
<figure>
  <img class=centered-img src="../img/20250604_damon.png" style="width:500px;" />
</figure>

<p>“You dropped a hundred and fifty grand on a f***** education you coulda' got for a dollar fifty in late charges at the public library.” —<em>Good Will Hunting</em></p>

<p>I was a user of computational chemistry for years, but one with relatively little understanding of how things actually worked below the input-file level. As I became more interested in computation in graduate school, I realized that I needed to understand everything much more deeply if I hoped to do interesting or original work in this space. From about August 2021 to December 2023, I tried to learn as much about how computational chemistry worked as I could, with the ultimate goal of being able to recreate my entire computational stack from scratch.</p>
<p>I found this task pretty challenging. Non-scientists don’t appreciate just how esoteric and inaccessible scientific knowledge can be: Wikipedia is laughably bad for most areas of chemistry, and most scientific knowledge isn’t listed on Google at all but trapped in bits and pieces behind journal paywalls. My goal in this post is to describe my journey and index some of the most relevant information I’ve found, in the hopes that anyone else hoping to learn about these topics has an easier time than I did.</p>
<p>This post is a directory, not a tutorial. I’m not the right person to explain quantum chemistry from scratch. Many wiser folks than I have already written good explanations, and my hope is simply to make it easier for people to find the “key references” in a given area. This post also reflects my own biases; it’s focused on molecular density-functional theory and neglects post-Hartree–Fock methods, most semiempirical methods, and periodic systems. If this upsets you, consider creating a companion post that fills the lacunæ—I would love to read it!</p>
<h2>0. Background</h2>
<p>I started my journey to understand computational chemistry with roughly three years of practice using computational chemistry. This meant that I already knew how to use various programs (Gaussian, ORCA, xTB, etc), I was actively using these tools in research projects, and I had a vague sense of how everything worked from reading a few textbooks and papers. If you don’t have any exposure to computational chemistry at all—if the acronyms “B3LYP”, “def2-TZVPP”, or “CCSD(T)” mean nothing to you—then this post probably won’t make very much sense.</p>
<p>Fortunately, it’s not too hard to acquire the requisite context. For an introduction to quantum chemistry, a good resource is Chris Cramer's <a href="https://www.youtube.com/watch?v=pu4uL7deCNw&amp;list=PLkNVwyLvX_TFBLHCvApmvafqqQUHb6JwF">video series</a> from his class at UMN. This is pretty basic but covers the main stuff; it's common for one of the classes in the physical chemistry sequence to also cover some of these topics. If you prefer books, <a href="https://www.amazon.com/Essentials-Computational-Chemistry-Theories-Models/dp/0470091827">Cramer</a> and <a href="https://www.amazon.com/Introduction-Computational-Chemistry-Frank-Jensen/dp/0470011874">Jensen</a> have textbooks that go slightly more in depth. </p>
<p>For further reading:</p>
<ul>
  <li>Steve Bachrach has a book on <a href="https://comporgchem.com/">computational organic chemistry</a> which discusses applying these techniques to a variety of problems in organic chemistry.</li>
  <li><a href="https://chemistlibrary.wordpress.com/wp-content/uploads/2015/02/modern-quantum-chemistry.pdf">Szabo/Ostlund</a> and <a href="https://www.amazon.com/Molecular-Electronic-Structure-Theory-Trygve-Helgaker/dp/1118531477">Helgaker/Jorgensen/Olsen</a> go much more into detail on the mathematics and implementation. (I confess I've only read parts of these books.)</li>
</ul>
<p>In general, computational chemistry is a fast-moving field relative to most branches of chemistry, so textbooks will be much less valuable than e.g. organic chemistry. There are lots of good review articles like <a href="https://onlinelibrary.wiley.com/doi/10.1002/anie.202205735">this one</a> which you can use to keep up-to-date with what's actually happening in the field recently, and reading the literature <a href="https://corinwagen.github.io/public/blog/20230329_literature.html">never goes out of style</a>.</p>
<p>All of the above discuss how to learn the theory behind calculations—to actually get experience running some of these, I'd suggest trying to reproduce a reaction that you've seen modeled in the literature. <a href="https://ekwan.github.io/notes.html#computational-chemistry">Eugene Kwan's notes are solid</a> (if Harvard-specific), and there are lots of free open-source programs that you can run like Psi4, PySCF, and xTB. (If you want to use Rowan, <a href="https://docs.rowansci.com/tutorials">we've got a variety of tutorials too.</a>) It's usually easiest to learn to do something by trying to solve a specific problem that you're interested in—I started out trying to model the effect of different ligands on the barrier to Pd-catalyzed C–F reductive elimination, which was tough but rewarding.</p>

<figure>
  <img class=centered-img src="../img/20250604_cf.png" style="width:650px;" />
</figure>

<p>Molecular dynamics is important but won’t be covered further here. The best scientific introduction to MD I've come across is <a href="https://sites.engineering.ucsb.edu/~shell/che210d/">these notes from M. Scott Shell</a>. If you want to go deeper, I really liked <a href="https://www.amazon.com/Understanding-Molecular-Simulation-Applications-Computational/dp/0122673514">Frenkel/Smit</a>; any knowledge of statistical mechanics will be very useful too, although I don’t have any recommendations for stat-mech textbooks. To get started actually running MD, I'd suggest looking into the OpenFF/OpenMM ecosystem, which is free, open-source, and moderately well-documented by scientific standards. (<a href="https://corinwagen.github.io/public/blog/20240613_simple_md.html">I've posted some intro scripts here</a>.)</p>
<p>Cheminformatics is a somewhat vaguely defined field, basically just "data science for chemistry," and it's both important and not super well documented. If you're interested in these topics, I recommend just reading <a href="https://patwalters.github.io/year-archive/">Pat Walters' blog</a> or <a href="https://greglandrum.github.io/rdkit-blog/">Greg Landrum's blog</a>: these are probably the two best cheminformatics resources.</p>
<p>As with all things computational, it's also worth taking time to build up a knowledge of computer science and programming—knowing how to code is an investment which will almost always pay itself back, no matter the field. That doesn't really fit into this guide, but being good at Python/Numpy/data science/scripting is worth pursuing in parallel, if you don't already have these skills.</p>

<h2>1. How do Things Work, Basically?</h2>
<p>I started my computational journey by trying to write my own quantum chemistry code from scratch. My disposition is closer to “tinkerer” than “theorist,” so I found it helpful to start tinkering with algorithms as quickly as possible to give myself <a href="https://marginalrevolution.com/marginalrevolution/2022/02/context-is-that-which-is-scarce-2.html">context</a> for the papers I was trying to read. There are several toy implementations of Hartree–Fock theory out there that are easy enough to read and reimplement yourself:</p>
<ul>
  <li><a href="https://nznano.blogspot.com/2018/03/simple-quantum-chemistry-hartree-fock.html">NZNano</a> has a compact Jupyter notebook that runs an HF/STO-3G calculation on helium hydride.</li>
  <li><a href="https://adambaskerville.github.io/posts/HartreeFockGuide/">Adam Baskerville</a> has a somewhat cleaner implementation of HF/STO-3G on HeH+, albeit one which doesn’t compute the one- and two-electron integrals.</li>
  <li><a href="https://github.com/jjgoings/McMurchie-Davidson">Joshua Goings</a> has a great general implementation of HF for any molecule or basis set, and <a href="https://joshuagoings.com/2017/04/28/integrals/">an associated blog post</a> explaining how to compute the integrals.</li>
</ul>
<p>Based on these programs, I wrote my own Numpy-based implementation of Hartree–Fock theory, and got it to match values from the NIST CCCBDB database.</p>

<pre class=code-block>
  iteration 05:	∆P 0.000001	E_elec -4.201085		∆E -0.000000

SCF done (5 iterations):
-2.83122 Hartree

orbital energies: [-2.30637605 -0.03929435]
orbital matrix: 
[[-0.71874445  0.86025802]
 [-0.44259188 -1.02992712]]
density matrix: 
[[1.03318718 0.63622091]
 [0.63622091 0.39177514]]
Mulliken charges:
[[1.32070648 0.81327091]
 [1.10313469 0.67929352]]
</pre>

<p>I highly recommend this exercise: it makes quantum chemistry much less mysterious, but also illustrates just how slow things can be when done naïvely. For instance, my first program took 49 minutes just to compute the HF/6-31G(d) energy of water, while most quantum chemistry codes can perform that calculation in under a second. Trying to understand this discrepancy was a powerful motivation to keep reading papers and learning new concepts.</p>

<h2>2. Overview</h2>
<p>Armed with a basic understanding of what goes into running a calculation, I next tried to understand how “real” computational chemists structure their software. The best single paper on this topic, in my opinion, is the <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.540030314">“direct SCF” Almlof/Faegri/Korsell paper from 1982</a>. It outlines the basic method by which almost all calculations are run today, and it’s pretty easy to read. (See also <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.540100111">this 1989 followup by Haser and Ahlrichs</a>, and <a href="https://link.springer.com/article/10.1007/s002149900072">this 2000 retrospective by Head-Gordon.</a>)</p>

<figure>
  <img class=centered-img src="../img/20250604_direct_scf.png" style="width:550px;" />
</figure>

<p>I found several other papers very useful for building high-level intuition. <a href="https://rsc.anu.edu.au/~pgill/papers/066ECC.pdf">This overview of self-consistent field theory by Peter Gill</a> is very nice, and <a href="https://schlegelgroup.wayne.edu/Pub_folder/32.pdf">Pople’s 1979 paper</a> on analytical first and second derivatives within Hartree–Fock theory is a must-read. <a href="https://www.worldscientific.com/doi/abs/10.1142/9789812832115_0008?srsltid=AfmBOopXU4ZCfegA2U-8HABNK_sBs_gU29cWUgfwv0diFtmKgs_RC2CF">This 1995 Pulay review</a> is also very good.</p>
<p>Using the intuition in these papers, I was able to outline and build a simple object-oriented Hartree–Fock program in Python. My code (which I called <span class=code>hfpy</span>, in allusion to <a href="https://www.sigmaaldrich.com/US/en/product/aldrich/184225">the reagent</a>) was horribly inefficient, but it was clean and had the structure of a real quantum chemistry program (unlike the toy Jupyter Notebooks above). Here’s some of the code that builds the Fock matrix, for instance:</p>

<pre class=code-block>
    for classname in quartet_classes.keys():
        num_in_class = len(quartet_classes[classname])
        current_idx = 0
        while current_idx &lt; num_in_class:
            batch = ShellQuartetBatch(quartet_classes[classname][current_idx:current_idx+Nbatch])

            # compute ERI
            # returns a matrix of shape A.Nbasis x B.Nbasis x C.Nbasis x D.Nbasis x NBatch
            ERIabcd = eri_MMD(batch)
            shell_quartets_computed += batch.size

            for i, ABCD in enumerate(batch.quartets):
                G = apply_ERI(G, *ABCD.indices, bf_idxs, ERIabcd[:,:,:,:,i], ABCD.degeneracy(), dP)

            current_idx += Nbatch

    # symmetrize final matrix
    # otherwise you mess up, because we've added (10|00) and not (01|00) (e.g.)
    G = (G + G.T) / 2
    if incremental:
        molecule.F += G
    else:
        molecule.F = molecule.Hcore + G

    print(f"{shell_quartets_computed}/{shell_quartets_possible} shell quartets computed")
</code></pre>
<p>Any quantum-chemistry developer will cringe at the thought of passing 5-dimensional ERI arrays around in Python—but from a pedagogical perspective, it’s a good strategy.</p>

<h2>3. Details</h2>
<p>Armed with a decent roadmap of what I would need to build a decent quantum chemistry program, I next tried to understand each component in depth. These topics are organized roughly in the order I studied them, but they’re loosely coupled and can probably be addressed in any order.</p>
<p>As I read about various algorithms, I implemented them in my code to see what the performance impact would be. (By this time, I had rewritten everything in C++, which made things significantly faster.) Here’s a snapshot of what my life looked like back then:</p>
<pre class=code-block>benzene / 6-31G(d)
    12.05.22 - 574.1 s - SHARK algorithm implemented

    12.20.22 - 507.7 s - misc optimization
    12.21.22 - 376.5 s - downward recursion for [0](m)
    12.22.22 - 335.9 s - Taylor series approx. for Boys function
    12.23.22 - 300.7 s - move matrix construction out of inner loops
    12.25.22 - 267.4 s - refactor electron transfer relation a bit
    12.26.22 - 200.7 s - create electron transfer engine, add some references
    12.27.22 - 107.9 s - cache electron transfer engine creation, shared_ptr for shell pairs
    12.28.22 -  71.8 s - better memory management, refactor REngine
    12.29.22 -  67.6 s - more memory tweaks

    01.03.23 -  65.1 s - misc minor changes
    01.05.23 -  56.6 s - create PrimitivePair object
    01.07.23 -  54.7 s - Clementi-style s-shell pruning
    01.08.23 -  51.7 s - reduce unnecessary basis set work upon startup
    01.10.23 -  49.9 s - change convergence criteria
    01.11.23 -  61.1 s - stricter criteria, dynamic integral cutoffs, periodic Fock rebuilds
    01.12.23 -  42.5 s - improved DIIS amidst refactoring

    01.20.23 -  44.7 s - implement SAD guess, poorly
    01.23.23 -  42.6 s - Ochsenfeld's CSAM integral screening
    01.30.23 -  41.7 s - improve adjoined basis set generally

    02.08.23 -  38.2 s - introduce spherical coordinates. energy a little changed, to -230.689906932 Eh.

    02.09.23 -  12.3 s - save ERI values in memory. refactor maxDensityMatrix.
    02.15.23 -   9.0 s - rational function approx. for Boys function
    02.18.23 -   8.7 s - minor memory changes, don't recreate working matrices in SharkEngine each time
</pre>

<p>
  Here's a rough list of the topics I studied, with the references that I found to be most helpful in each area.
</p>

<h3>3.1 ERI Computation</h3>
<p>Writing your own QM code illustrates (in grisly fashion) just how expensive computing electron–electron repulsion integrals (ERIs) can be. This problem dominated the field’s attention for a long time. In the memorable words of Jun Zhang:</p>
<blockquote>
  Two electron repulsion integral. It is quantum chemists’ nightmare and has haunted in quantum chemistry since its birth.
</blockquote>
<p>To get started, Edward Valeev has written <a href="https://arxiv.org/ftp/arxiv/papers/2007/2007.12057.pdf">a good overview of the theory behind ERI computation</a>. For a broad overview of lots of different ERI-related ideas, my favorite papers are these two accounts by <a href="https://rsc.anu.edu.au/~pgill/papers/045Review.pdf">Peter Gill</a> and <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/jcc.26942">Frank Neese</a>. (I’ve probably read parts of Gill’s review almost a hundred times.)</p>
<p>Here are some other good ERI-related papers, in rough chronological order:</p>
<ul>
  <li><a href="https://www.sciencedirect.com/science/article/abs/pii/0009261473800600">This 1973 paper by Raffinetti</a> discusses a non-direct SCF strategy for storing integrals on disk, which is still commonly used for small systems.</li>
  <li><a href="https://pubs.aip.org/aip/jcp/article-abstract/89/9/5777/220762/A-method-for-two-electron-Gaussian-integral-and?redirectedFrom=fulltext">This 1989 paper from Head-Gordon and Pople</a> outlines the basic algorithm by which most programs tackle ERI computation today. (The core ideas were developed by <a href="https://pubs.aip.org/aip/jcp/article-abstract/84/7/3963/91928/Efficient-recursive-computation-of-molecular?redirectedFrom=fulltext">Obara and Saika</a>, but I find that paper pretty unintelligible.) <a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.560360831">Peter Gill’s extension of this work</a> is also quite nice (see also his review above).</li>
  <li><a href="https://pubs.aip.org/aip/jcp/article-abstract/104/7/2620/479230/A-J-matrix-engine-for-density-functional-theory?redirectedFrom=fulltext">This 1996 White/Head-Gordon paper</a> proposes the “<em>J</em>-matrix engine” and <a href="https://www.sciencedirect.com/science/article/abs/pii/S0009261400005248">this 2000 paper</a> suggests some enhancements.</li>
  <li>Todd Martínez has a great series of papers discussing ERI evaluation on GPUs: <a href="https://pubs.acs.org/doi/10.1021/ct700268q">1</a>, <a href="https://pubs.acs.org/doi/abs/10.1021/ct800526s">2</a>, <a href="https://pubs.acs.org/doi/10.1021/ct9003004">3</a></li>
  <li>Ochsenfeld and Head-Gordon’s <a href="https://pubs.aip.org/aip/jcp/article-abstract/109/5/1663/529170/Linear-and-sublinear-scaling-formation-of-Hartree?redirectedFrom=fulltext">LinK strategy</a> for accelerated exchange computation is very nice. (And resolution-of-the-identity approaches can help here too: see <a href="https://pubs.aip.org/aip/jcp/article/143/2/024113/825080/Fast-accurate-evaluation-of-exact-exchange-The-occ">Manzer’s “occ-RI-K” strategy</a>.)</li>
  <li><a href="https://pubs.acs.org/doi/abs/10.1021/acs.jctc.7b00788">Jun Zhang has a paper</a> on metaprogramming-based approaches to ERI computation.</li>
  <li>Benjamin Pritchard has <a href="https://onlinelibrary.wiley.com/doi/10.1002/jcc.24483">a paper on vectorization in ERI computation</a>.</li>
  <li>C. David Sherrill discusses permutational symmetry in <a href="http://vergil.chemistry.gatech.edu/notes/permsymm/permsymm.html">these notes</a>.</li>
  <li>Integral screening matters a lot; I discuss it in <a href="https://corinwagen.github.io/public/blog/20230123_integral_screening.html">this blog post</a> from January 2023, which is roughly when I was learning all of this.</li>
</ul>

<h3>3.2 SCF Convergence</h3>
<p>Writing your own QM code also illustrates how important SCF convergence can be. With the most naïve approaches, even 15–20 atom molecules often struggle to converge—and managing SCF convergence is still relatively unsolved in lots of areas of chemistry today, like radicals or transition metals.</p>

<figure>
  <img class=centered-img src="../img/20250604_scf.png" style="width:500px;" />
  <figcaption>
    Different SCF-convergence strategies and how they fare on tricky systems (from Scuseria, <i>JCP</i>, <b>2012</b>; <i>vide infra</i>)
  </figcaption>
</figure>

<p>This is obviously a big topic, but here are a few useful references:</p>
<ul>
  <li><a href="https://schlegelgroup.wayne.edu/Pub_folder/126.pdf">This 1991 review</a> by Schlegel and Douall is a good overview of SCF convergence questions.</li>
  <li>The most fundamental approach is Pulay’s “direct inversion of the iterative subspace” (DIIS): the original paper is <a href="https://www.sciencedirect.com/science/article/abs/pii/0009261480803964?via%3Dihub">here</a>, but this is famous enough that there are plenty of good and more modern summaries out there (<a href="https://joshipulkit.github.io/notes/diis/">1</a>, <a href="http://vergil.chemistry.gatech.edu/notes/diis/node2.html">2</a>, <a href="https://github.com/psi4/psi4numpy/blob/master/Tutorials/03_Hartree-Fock/3b_rhf-diis.ipynb">3</a>).</li>
  <li><a href="https://pmc.ncbi.nlm.nih.gov/articles/PMC2830258/">This 2010 paper</a> describes the “ADIIS” strategy, and <a href="https://pubs.aip.org/aip/jcp/article-abstract/137/5/054110/671630/Comparison-of-self-consistent-field-convergence?redirectedFrom=fulltext">this 2012 Scuseria paper</a> shows that ADIIS and “energy DIIS” (EDIIS) are equivalent.</li>
  <li><a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.20393">This 2006 paper</a> is a good guide to the “superposition of atomic density” guess strategy.</li>
  <li><a href="https://www.sciencedirect.com/science/article/abs/pii/S0065327608603391">Lowdin’s 1970 paper</a> on orthonormalization and removing linear dependencies in basis sets is solid.</li>
  <li><a href="https://onlinelibrary.wiley.com/doi/abs/10.1002/qua.560070407">This 1973 Saunders paper</a> describes “level shifting,” which is ubiquitous today.</li>
</ul>

<h3>3.3 Density Fitting/Resolution of the Identity</h3>
<p>Density-fitting/resolution-of-the-identity (“RI”) approaches are becoming <em>de rigueur</em> for most applications. <a href="https://www.sciencedirect.com/science/article/abs/pii/000926149500621A">This 1995 Ahlrichs paper</a> explains “RI-J”, or density fitting used to construct the J matrix (<a href="https://www.sciencedirect.com/science/article/abs/pii/0009261493891517">this 1993 paper</a> is also highly relevant.) <a href="https://pubs.rsc.org/en/content/articlelanding/2002/cp/b204199p">This 2002 Weigend paper</a> extends RI-based methods to K-matrix construction. <a href="http://vergil.chemistry.gatech.edu/notes/df.pdf">Sherrill’s notes</a> are useful here, as is <a href="https://github.com/psi4/psi4numpy/blob/master/Tutorials/03_Hartree-Fock/density-fitting.ipynb">the Psi4Numpy tutorial</a>.</p>
<p>RI methods require the use of auxiliary basis sets, which can be cumbersome to deal with. <a href="https://pubs.acs.org/doi/10.1021/acs.jctc.6b01041">This 2016 paper</a> describes automatic auxiliary basis set generation, and <a href="https://pubs.acs.org/doi/10.1021/acs.jctc.3c00670">this 2023 paper</a> proposes some improvements. <a href="https://molssi-bse.github.io/basis_set_exchange/developer_api.html#basis_set_exchange.manip.autoaux_basis">There’s now a way</a> to automatically create auxiliary basis sets through the Basis Set Exchange API.</p>

<h3>3.4 Mechanics of Density-Functional Theory</h3>
<p>For Hartree–Fock theory, there are a lot of nice example programs (linked above); for density-functional theory, there are fewer examples. Here are a few resources which I found to be useful:</p>
<ul>
  <li><a href="https://pubs.aip.org/jcp/article/88/4/2547/91134/A-multicenter-numerical-integration-scheme-for">This 1988 paper</a>, from Becke, basically describes how all DFT quadrature is done today. I find <a href="https://www.sciencedirect.com/science/article/abs/pii/0009261496006008">this 1996 Stratmann paper</a> to be much more readable, though (plus it’s a linear-scaling method).</li>
  <li><a href="https://pubs.aip.org/aip/jcp/article-abstract/98/7/5612/843250/The-performance-of-a-family-of-density-functional?redirectedFrom=fulltext">This 1993 paper</a> by Gill and Head-Gordon discusses how to get analytical DFT gradients (among other things). Here's the key equation:

  <figure>
    <img class=centered-img src="../img/20250604_dft_grad.png" style="width:400px;" />
  </figure>

    This is the clearest exposition of the math behind DFT that I’ve read, although it doesn’t cover meta-GGA functionals or range-separated hybrids. (There’s a <a href="https://github.com/psi4/psi4numpy/blob/master/Tutorials/04_Density_Functional_Theory/4c_GGA_and_Meta_GGA.ipynb">Psi4Numpy explanation</a> of the math behind meta-GGA functionals, if you can parse the insane Psi4 syntax.)</li>
  <li><a href="https://www.sciencedirect.com/science/article/abs/pii/0009261494001995">This 1994 paper</a> discusses how to make DFT calculations with numerical quadrature rotationally invariant, which <a href="https://chemrxiv.org/engage/chemrxiv/article-details/60c74474ee301c02d6c7916e">many programs still haven’t figured out</a>…</li>
  <li><a href="https://pubs.aip.org/aip/jcp/article-abstract/101/10/8894/472028/The-effect-of-grid-quality-and-weight-derivatives?redirectedFrom=fulltext">This other 1994 paper</a> argues that it’s not necessary to add grid weight derivatives with large grids. People still argue about this one.</li>
  <li>The first paper describing range-separated hybrids, as far as I can tell, is <a href=https://pubs.aip.org/aip/jcp/article-abstract/118/18/8207/460359/Hybrid-functionals-based-on-a-screened-Coulomb?redirectedFrom=fulltext>this 2003 work</a> from Scuseria and co-workers.</li>
</ul>

<h3>3.5 Linear Scaling</h3>
<p>For large systems, it’s possible to find pretty large speedups and reach a linear-scaling regime for DFT (excepting operations like matrix diagonalization, which are usually pretty fast anyway). <a href="https://www.sciencedirect.com/science/article/abs/pii/0009261494011281">This 1994 paper</a> discusses extending the fast multipole method to Gaussian distributions, and how this can lead to linear-scaling <em>J</em>-matrix construction, and <a href="https://www.science.org/doi/10.1126/science.271.5245.51">this 1996 paper</a> discusses a similar approach. <a href="https://pubs.aip.org/aip/jcp/article-abstract/105/19/8969/479837/A-linear-scaling-method-for-Hartree-Fock-exchange?redirectedFrom=fulltext">This other 1996 paper</a> describes a related near-linear-scaling approach for <em>K</em> matrices. There are a bunch more papers on various approaches to linear scaling (Barnes–Hut, CFMM, GvfMM, Turbomole’s RI/CFMM, etc), but I think there are diminishing marginal returns in reading all of them.</p>

<h3>3.6 Geometry Optimization</h3>
<p>Geometry optimization for molecular systems is pretty complicated. Here’s a sampling of different papers, with the caveat that this doesn’t come close to covering everything:</p>
<ul>
  <li><a href="https://schlegelgroup.wayne.edu/Pub_folder/50.pdf">This 1981 Schlegel paper</a> explores the general considerations in optimizing molecules with quantum chemical methods.</li>
  <li><a href="https://link.springer.com/article/10.1007/BF00554788">This 1984 Schlegel paper</a> discusses the importance of initial Hessians in geometry optimization.</li>
  <li><a href="https://schlegelgroup.wayne.edu/Pub_folder/180.pdf">This 1996 Schlegel/Frisch paper</a> discusses use of internal coordinates for geometry optimizations, which is standard today, and <a href="https://schlegelgroup.wayne.edu/Pub_folder/390.pdf">this 2016 paper</a> explores some enhancements.</li>
  <li><a href="https://pubs.acs.org/doi/10.1021/ct050275a">This 2006 paper</a> extends the DIIS scheme to geometry optimization; this still seems underrated today.</li>
  <li><a href="https://pubs.aip.org/aip/jcp/article-abstract/140/16/164115/841317/A-finite-difference-Davidson-procedure-to-sidestep?redirectedFrom=PDF">This 2014 paper</a> discusses a way to obtain the lowest eigenvalues of the Hessian without computing the full matrix, thus accelerating TS searches.</li>
  <li><a href="https://chemrxiv.org/engage/chemrxiv/article-details/64e37e3700bbebf0e68dd9c4">This 2023 paper</a> benchmarks existing optimization algorithms, albeit for somewhat boring molecules.</li>
</ul>

<h3>3.7 Frequency + Thermochemistry</h3>
<p>I think the best guides here are <a href="https://gaussian.com/vib/">the Gaussian vibrational analysis white paper</a> and <a href="https://gaussian.com/vib/">the Gaussian thermochemistry white paper</a>—they basically walk through everything that’s needed to understand and implement these topics. It’s now pretty well-known that small vibrational frequencies can lead to thermochemistry errors; <a href="https://rowansci.com/blog/dft-errors">Rowan has a blog post</a> that discusses this and similar errors.</p>

<h3>3.8 Solvent</h3>
<p>Implicit solvent models, while flawed, are still essential for a lot of applications. <a href="https://pubs.rsc.org/en/content/articlelanding/1993/p2/p29930000799">This 1993 paper</a> describes the COSMO solvation method, upon which most modern implicit solvent methods are built. <a href="https://pubs.acs.org/doi/10.1021/jp992097l">Karplus and York found a better way to formulate these methods in 1999</a>, which makes the potential-energy surface much less jagged: </p>

<figure>
  <img class=centered-img src="../img/20250604_solvent.png" style="width:500px;" />
</figure>

<p>While there are many more papers that one could read in this field, these are the two that I found to be most insightful.</p>

<h3>3.9 Basis Sets Miscellania</h3>
<p>I haven’t talked much about basis sets specifically, since most basis-set considerations are interwoven with the ERI discussion above. But a few topics warrant special mention:</p>
<ul>
  <li><a href="https://www.sciencedirect.com/science/article/abs/pii/0009261496009177">This 1996 paper by Davidson</a> discusses how to convert general contraction into segmented contraction, which is important since the latter is much easier to handle.</li>
  <li>The issue of converting between spherical and Cartesian basis sets is tackled by <a href="https://onlinelibrary.wiley.com/doi/10.1002/qua.560540202">this 1995 work from Schelgel and Frisch</a>.</li>
</ul>




<h2>4. Conclusions</h2>
<p>There are hundreds of other papers which could be cited on these topics, to say nothing of the myriad topics I haven’t even mentioned here, but I think there’s diminishing marginal utility in additional links. The knowledge contained in the above papers, plus ancillary other resources, were enough to let me write my own quantum-chemistry code. Over the course of learning all this content, I wrote four different QM programs, the last of which, “Kestrel,” ended up powering Rowan for the first few months after we launched.</p>
<p>These programs are no longer directly relevant to anything we do at Rowan. We retired Kestrel last summer, and now exclusively use external quantum-chemistry software to power our users’ calculations (although I’ve retained some strong opinions; we explicitly override Psi4’s defaults to use the Stratmann–Scuseria–Frisch quadrature scheme, for instance).</p>
<p>But the years I spent working on this project were, I think, an important component of my scientific journey. Rene Girard says that <a href="https://corinwagen.github.io/public/blog/20230228_gilliam_and_girard.html">true innovation requires a “mastery” of the past’s achievements</a>. While I’m far from mastering quantum chemistry, I think that I’d be ill-suited to understand the impact of recent advances in neural network potentials without having immersed myself in DFT and conventional physics-based simulation for a few years.</p>
<p>And, on a more personal note, learning all this material was deeply intellectually satisfying and a fantastic use of a few years. I hope this post conveys some of that joy and can be helpful for anyone who wants to embark on a similar adventure. If this guide helped you and you have thoughts on how I could make this better, please feel free to reach out!</p>
<p><em>Thanks to Peter Gill, Todd Martínez, Jonathon Vandezande, Troy Van Voorhis, Joonho Lee, and Ari Wagen for helpful discussions.</em></p>

</div><div class='next-link'><a href='blog_p2.html'>next page</a></div><br>
  </body>
  <br>
  <footer>
    <a href="mailto:corin.wagen+blog@gmail.com">email</a>
    <a href="https://github.com/corinwagen">github</a>
    <a href="https://twitter.com/CorinWagen">x</a>
    <a href="https://scholar.google.com/citations?user=SW0Uhs0AAAAJ">google scholar</a>
    <div style="float:right;">
      <a href="/rss.xml">rss</a>
      <a href="https://cwagen.substack.com">substack</a>
    </div>
  </footer>
</html>
