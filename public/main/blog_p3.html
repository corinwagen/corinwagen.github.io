<!DOCTYPE html>
<html>
  <head>
    <title>
      Blog
    </title>
    <meta charset="utf-8">
    <meta name="description" content="">
    <meta name="language" content="en">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="../../static/style.css">

    <link rel="alternate" type="application/rss+xml" title="RSS feed for the blog" href="/rss.xml">

    <!--google-->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-MTNZ0ZSG3W"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
      gtag('config', 'G-MTNZ0ZSG3W');
    </script>

  </head>
  <body>
    <ul class="menu-list">
      <li class="menu-item"><a href="index.html" class="menu-link menu-title">Corin Wagen</a></li>
      <li class="menu-item"><a href="index.html#about" class="menu-link">About</a></li>
      <li class="menu-item"><a href="index.html#projects" class="menu-link">Projects</a></li>
      <!--<li class="menu-item"><a href="index.html#past_work" class="menu-link">Past Work</a></li>-->
      <li class="menu-item">
        <a href="blog_p1.html" class="menu-link">Blog</a>
        <a href='archive.html' class="menu-link">(Archive)</a>
      </li>
    </ul>
    <h1 class='blogroll-header'>Blog</h1><div class='previous-link'><a href='blog_p2.html'>previous page</a></div><div class='next-link'><a href='blog_p4.html'>next page</a></div><br><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20231016_networking.html'>Networking, For Skeptics</a></h2><i>October 16, 2023</i>
<figure>
  <img class=centered-img src=https://arthistorybuff.files.wordpress.com/2017/10/dp819996.jpg style="width:400px;" />
  <figcaption>
    "Hi, would you like to connect on LinkedIn?"
  </figcaption>
</figure>

<p>
<i>
(in the spirit of Dale Carnegie and post-rat <a href=https://sympatheticopposition.substack.com/p/how-and-why-to-be-ladylike-for-women>etiquette guides</a>)
</i>
</p>

<p>
Scientists, engineers, and other technical people often make fun of networking. Until a few years ago, I did this too: I thought networking was some dumb activity done by business students who didn’t have actual work to do, or something exploitative focused on pure self-advancement. But over the past year or so, I’ve learned why networking is important, and have found a way to network that doesn’t make me feel uncomfortable or selfish. I want to share my current thoughts here, in case they help anyone else.
</p>

<p>
The first thing to recognize is that networking matters because we live in a world of relationships. Technical people often struggle with this point: to some, relying on relationships feels imprecise or even nepotistic. But we’re human beings, not stateless automata communicating via some protocol, and it’s inevitable (and appropriate) for us to form relationships and care about them.
</p>

<p>
Having the right relationships can make a big difference. We trust people we know much more than we trust strangers. It’s weird for someone whom you’ve never met to email you asking for a favor, but very normal for a friend or acquaintance to reach out and ask for something. And most ambitious projects (academia, startups, etc) are limited not by money but by human capital: there are only so many talented people out there, and if you can’t get access to them, what you’re doing will suffer. (On a macro level, this explains why management consulting has become so important.)
</p>

<p>
So it’s worth intentionally building relationships before you have an immediate need. There are a lot of people,<sup>[citation needed]</sup> so how might one go about this? One obvious strategy might be to build relationships with people you think could be useful to you. But this doesn’t work very well. It’s not always obvious what will or won’t be useful in the future, and far too easy to let status quo bias reign supreme. (Most graduate students struggle to imagine how knowing someone from another subfield could ever be useful, let alone someone who isn’t a scientist, which makes it tough when they want to do <a href=https://news.ycombinator.com/item?id=24459155>something outside academia.</a>)
</p>

<p>
Another downside to this strategy is that you have to partition people into “useful” or “not useful” upon meeting them. This is self-defeating: most people can figure out when you’re treating them only as a means to an end, so walking around evaluating everyone’s utility tends to poison your interactions. Plus, it’s a very Machiavellian way to view the world, and ought to make you feel a little gross.
</p>

<p>
Instead, a better strategy is to accept that you won’t be able to predict <i>a priori</i> who will be useful and instead just try and meet people. If the end goal of networking is to find people you’ll be able to collaborate with in the future, in one capacity or another, then it’s important to find people who share your values and who you get along with: in other words, friends. So, rather than worrying about if it’ll be better to know a renewable energy consultant or a paralegal for a medical device company, you can just see who you like spending time with and go from there.
</p>

<p>
If we think of networking as synonymous to making friends, then it also becomes more obvious when and how one should network. Anything explicitly framed as an opportunity for networking is a bad choice: these events tend to attract people who are self-centered, and mostly end up revolving around LinkedIn (the Tinder of networking?). Instead, look for places where you’ll find people you could be friends with. For me, this ends up mostly being church and church-adjacent spaces like Bible studies; I’m not sure what the analogous space for non-religious people is.
</p>

<p>
The strategies I’ve discussed above are framed in terms of “demand-side networking,” or how you can find ways to acquire human capital when you have a demand for it. But the same considerations apply to “supply-side networking,” or marketing oneself to potential people. The beauty of treating networking simply as making friends is that you’re not committing to any particular outcome: maybe you’ll benefit from it, maybe the other person will benefit from it, or maybe both of you will (or neither). The expected value of building new relationships should always be positive, which means that networking isn’t a zero-sum game: it’s good for all involved.
</p>

<p>
The conclusion I want to leave you with is this: networking, rightly understood, just means living in a way that recognizes our dependence on other people. To live life as a “networker” means putting yourself in places where you might make new friends, looking for common ground in all your interactions, and trying to recognize others’ talents and abilities. Networking isn’t some Randian pursuit focused on extracting value from those around us. It should be done with humility, accepting that we need other people to thrive and being open to whatever relationships come our way.
</p>

<i>Thanks to Ari Wagen for editing drafts of this post.</i>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20230922_composite.html'>Composite Methods in Quantum Chemistry</a></h2><i>September 22, 2023</i>
<br>
<br>
<p class=epigraph>
“A cord of three strands is not easily broken.”
</p>
<p class=epigraph-byline>
—Ecclesiastes 4:12
</p>

<figure>
  <img class=centered-img src=https://upload.wikimedia.org/wikipedia/commons/thumb/5/5f/Rams%C3%A9s_II_en_Qadesh%2C_relieve_de_Abu_Simbel.jpg/773px-Rams%C3%A9s_II_en_Qadesh%2C_relieve_de_Abu_Simbel.jpg style="width:350px;" />
  <figcaption>
    Abu Simbel relief of Ramesses II shooting a composite bow at the Battle of Kadesh.
  </figcaption>
</figure>

<p>
Computational chemistry, like all attempts to simulate reality, is defined by tradeoffs. Reality is far too complex to simulate perfectly, and so scientists have developed a plethora of approximations, each of which reduces both the cost (i.e. time) and the accuracy of the simulation. The responsibility of the practitioner is to choose an appropriate method for the task at hand, one which best balances speed and accuracy (or to admit that no suitable combination exists).
</p>

<p>
This situation can naturally be framed in terms of <a href=https://en.wikipedia.org/wiki/Pareto_efficiency>Pareto optimality</a>: there’s some “frontier” of speed/accuracy combinations which are at the limit of what’s possible, and then there are suboptimal combinations which are inefficient. Here’s a nice plot illustrating exactly that, from Dakota Folmsbee and Geoff Hutchinson (<a href=https://onlinelibrary.wiley.com/doi/full/10.1002/qua.26381>ref</a>):
</p>

<figure>
  <img class=centered-img src=../img/20230922_pareto.png style="width:550px;" />
  <figcaption>
    The y axis represents R<sup>2</sup> among different (relative) conformer energies, and the x axis is a log scale of computational time. The pattern shown here—exponential increases in time for linear increases in accuracy—is pretty common, unfortunately.
  </figcaption>
</figure>

<p>
In this figure, the top left corner is the goal—perfect accuracy in no time at all—and the bottom right corner is the opposite. The diagonal line represents the Pareto frontier, and we can see that different levels of theory put you at different places along the frontier. <i>Ab initio</i> methods (DFT, MP2, coupled cluster) are slow but accurate, while force fields are fast but inaccurate, and semiempirical methods and ML methods are somewhere in the middle. (It’s interesting to observe that some ML methods are quite far from the optimal frontier, but I suppose that’s only to be expected from such a new field.)
</p>

<p>
An important takeaway from this graph is that some regions of the Pareto frontier are easier to access than others. Within e.g. DFT, it’s relatively facile to tune the accuracy of the method employed, but it’s much harder to find a method intermediate between DFT and semiempirical methods. (For a variety of reasons that I’ll write about later, this region of the frontier seems particularly interesting to me, so it’s not just an intellectual question.) This lacuna is what Stefan Grimme’s “composite” methods, the subject of today’s post, are trying to address.
</p>


<figure>
  <img class=centered-img src="https://upload.wikimedia.org/wikipedia/commons/a/a9/Zhangxian02.jpg" style="width:250px;" />
  <figcaption>
    I like to believe that these methods are named after the composite recurve bow, which is both smaller and more powerful than simple bows, but I don’t have evidence for this belief. 
    Pictured is Qing dynasty artwork of Zhang Xian shooting a composite bow.
  </figcaption>
</figure>

<p>
What defines a composite method? The term hasn’t been precisely defined in the literature (as far as I’m aware), but the basic idea is to strip down existing <i>ab initio</i> electronic structure methods as much as possible, particularly the basis sets, and employ a few additional corrections to fix whatever inaccuracies this introduces. Thus, composite methods still have the essential form of DFT or Hartree–Fock, but rely heavily on cancellation of error to give them better accuracy than one might expect. (This is in contrast to semiempirical methods like <i>xtb</i>, which start with a more approximate level of theory and layer on a ton of corrections.)
</p>

<p>
Grimme and coworkers are quick to acknowledge that their ideas aren’t entirely original. To quote from their first composite paper (on HF-3c):
</p>

<blockquote>
Several years ago Pople noted that HF/STO-3G optimized geometries for small molecules are excellent, better than HF is inherently capable of yielding. Similar observations were made by Kołos already in 1979, who obtained good interaction energies for a HF/minimal-basis method together with a counterpoise-correction as well as a correction to account for the London dispersion energy. It seems that part of this valuable knowledge has been forgotten during the recent “triumphal procession” of DFT in chemistry. The true consequences of these intriguing observations could not be explored fully at that time due to missing computational resources but are the main topic of this work.
</blockquote>

<p>
And it’s not as though minimal basis sets have been forgotten: <a href=https://link.springer.com/article/10.1007/BF01127507>MIDIX</a> still sees use (I used it during my PhD), and Todd Martinez has been exploring <a href=https://pubs.acs.org/doi/10.1021/jp307741u>these ideas</a> for a while. Nevertheless, composite methods seem to have attracted attention in a way that the above work hasn’t. I’ll discuss why this might be at the end of the post—but first, let’s discuss what the composite methods actually are.
</p>

<h2>
HF-3c (2013)
</h2>

<p>
<a href=https://onlinelibrary.wiley.com/doi/abs/10.1002/jcc.23317>HF-3c</a> is a lightweight Hartree–Fock method, using a minimal basis set derived from Huzinaga’s MINIS basis set. To ameliorate the issues that Hartree–Fock and a tiny basis set cause, the authors layer in three corrections: the D3 dispersion correction (with Becke–Johnson damping), their recent <a href=https://pubs.aip.org/aip/jcp/article-abstract/136/15/154101/941628/A-geometrical-correction-for-the-inter-and-intra?redirectedFrom=fulltext>“gCP”</a> geometric counterpoise correction for basis set incompleteness error, and an “SRB” short-range basis correction for electronegative elements.
</p>

<p>
HF-3c is surprisingly good at geometry optimization and noncovalent interaction energies (MAE of 0.39 kcal/mol on the S66 benchmark set), works okay for <a href=https://pubs.acs.org/doi/abs/10.1021/acs.jpca.1c10144>dipole moments</a> and vibrational frequencies, but seems bad for anything involving bond breaking. Thus the authors recommend it for optimization of ground-state complexes, and not so much for finding an entire potential energy surface.
</p>

<figure>
  <img class=centered-img src=../img/20230922_hf3c.png style="width:450px;" />
  <figcaption>
    Comparison of HF-3c and PM6 for geometry optimization, relative to B3LYP-D3/def2-TZVPP (black).
  </figcaption>
</figure>

<p>
(One complaint about all of these papers: the basis set optimization isn’t described in much detail, and we basically have to take the authors’ word that what they came up with is actually the best.)
</p>

<h2>
HF-3c(v) (2014)
</h2>

<p>
<a href=https://pubs.acs.org/doi/10.1021/jz5021313>HF-3c(v)</a> is pretty much the same as HF-3c, but it uses a “large-core” effective core potential to describe all of the core electrons, making it valence-only. This makes it 2–4 times faster, but also seems to make it much worse than HF-3c: I’m not sure the speed is worth the loss in accuracy.
</p>

<p>
The authors only use it to explore noncovalent interactions; I’m not sure if others have used it since.
</p>

<h2>
PBEh-3c (2015)
</h2>

<p>
<a href=https://pubs.aip.org/aip/jcp/article-abstract/143/5/054107/194086/Consistent-structures-and-interactions-by-density?redirectedFrom=fulltext>PBEh-3c</a> is the next “3c” method, and the first composite DFT method. As opposed to the minimal basis set employed in HF-3c, Grimme et al here elect to use a polarized double-zeta basis set, which “significantly improves the energetic description without sacrificing the computational efficiency too much.” They settle on a variant of def2-SV(P) with an effective core potential and a few other modifications, which they call “def-mSVP.”
</p>

<p>
As before, they also add the D3 and gCP corrections (both slightly modified), but they leave out the SRB correction. The biggest change is that they also reparameterize the PBE functional, which introduces an additional four parameters: three in PBE, and one to tune the percentage of Fock exchange. The authors note that increasing the Fock exchange from 25% to 42% offsets the error introduced by basis set incompleteness.
</p>

<p>
As before, the focus of the evaluation is on geometry optimization, and PBEh-3c seems to do very well (although not better than HF-3c on e.g. S66, which is surprising—the authors also don’t compare directly to HF-3c in the paper at all). PBEh-3c also does pretty well on the broad GMTKN30 database, which includes thermochemistry and barrier heights, faring just a bit worse than M06-2x/def2-SV(P).
</p>

<h2>
HSE-3c (2016)
</h2>

<p>
<a href=https://pubs.rsc.org/en/content/articlelanding/2016/CP/C6CP01697A>HSE-3c</a> is basically the same as PBEh-3c, but now using a screened exchange variant to make it more robust and faster for large systems or systems with small band gaps. The authors recommend using PBEh-3c for small molecules or large band-gap systems, which is my focus here, so I won’t discuss HSE-3c further.
</p>

<h2>
B97-3c (2018)
</h2>

<p>
<a href=https://pubs.aip.org/aip/jcp/article-abstract/148/6/064104/196461/B97-3c-A-revised-low-cost-variant-of-the-B97-D?redirectedFrom=fulltext>B97-3c</a> is another DFT composite method, but it’s a bit different than PBEh-3c. PBE is a pretty simple functional with only three tunable parameters, while B97 is significantly more complex with ten tunable parameters. Crucially, B97 is a pure functional, meaning that no Fock exchange is involved, which comes with benefits and tradeoffs. The authors write:
</p>

<blockquote>
The main aim here is to complete our hierarchy of “3c” methods by approaching the accuracy of large basis set DFT with a physically sound and numerically well-behaved approach.
</blockquote>

<p>
For a basis set, the authors use a modified form of def2-TZVP called “mTZVP”, arguing that “as the basis set is increased to triple-ζ quality, we can profit from a more flexible exchange correlation functional.” This time, the D3 and SRB corrections are employed, but the gCP correction is omitted.
</p>

<p>
The authors do a bunch of benchmarking: in general, B97-3c seems to be substantially better than either PBEh-3c or HF-3c at every task, which isn’t surprising given the larger basis set. B97-3c is also often better than e.g. B3LYP-D3 with a quadruple-zeta basis set, meaning that it can probably be used as a drop-in replacement for most routine tasks.
</p>

<figure>
  <img class=centered-img src=../img/20230922_b973c_rot.png style="width:450px;" />
  <figcaption>
    Comparison of a few methods for geometry optimization, as assessed by rotational constants. Both B97-3c and PBEh-3c perform better than HF-3c. 
  </figcaption>
</figure>

<h2>
B3LYP-3c (2020)
</h2>

<p>
<a href=https://pubs.acs.org/doi/10.1021/acs.jctc.0c00877>B3LYP-3c</a> is a variant of PBEh-3c where you just remove the PBEh functional and replace it with B3LYP (without reparameterizing B3LYP at all). This is done to improve the accuracy for vibrational frequencies, since B3LYP performs quite well for frequencies. I’ve only seen this in one paper, so I’m not sure this will catch on (although it does seem to work).
</p>

<h2>
r<sup>2</sup> SCAN-3c (2021)
</h2>

<p>
Continuing our journey through the “Jacob’s ladder” of composite functionals, we arrive at <a href=https://pubs.aip.org/aip/jcp/article-abstract/154/6/064103/199831/r2SCAN-3c-A-Swiss-army-knife-composite-electronic?redirectedFrom=fulltext>r<sup>2</sup> SCAN-3c</a>, based on the meta-GGA r<sup>2</sup> SCAN functional. No reparameterization of the base functional is performed, but the D4 and gCP corrections are added, and yet another basis set is developed: mTZVPP, a variant of the mTZVP basis set developed for B97-3c, which was already a variant of def2-TZVP.
</p>

<p>
The authors describe the performance of r<sup>2</sup> SCAN-3c in rather breathless terms:
</p>

<blockquote>
…we argue that r<sup>2</sup> SCAN is the first mGGA functional that truly climbs up to the third rung of the Jacobs ladder without significant side effects (e.g., numerical instabilities or an overfitting behavior that leads to a bad performance for the mindless benchmark set).
<br><br>
…the new and thoroughly tested composite method r<sup>2</sup> SCAN-3c provides benchmark-accuracy for key properties at a fraction of the cost of previously required hybrid/QZ approaches and is more robust than any other method of comparable cost. This drastically shifts the aforementioned balance between the computational efficiency and accuracy, enabling much larger and/or more thorough screenings and property calculations. In fact, the robustness and broad applicability of r<sup>2</sup> SCAN-3c caused us to rethink the very structure of screening approaches.
</blockquote>

<p>
The amount of benchmarking performed is a little overwhelming. Here’s a nice figure that summarizes r<sup>2</sup> SCAN-3c on the GMTKN55 database, and also compares it to B97-3c:
</p>

<figure>
  <img class=centered-img src=../img/20230922_r2scan_acc.png style="width:450px;" />
  <figcaption>
  Notice how much better the results are than B97-3c.
  </figcaption>
</figure>

<p>
And here’s a nice graph that shows time comparisons for a 153-atom system, which is something that’s obviously a key part of the value-add:
</p>

<figure>
  <img class=centered-img src=../img/20230922_r2scan_speed.png style="width:500px;" />
  <figcaption>
  r<sup>2</sup> SCAN-3c is only a bit slower than B97-3c, and both are substantially faster than PBEh-3c (probably because PBEh is a global hybrid). HF-3c, of course, is still fastest.
  </figcaption>
</figure>

<h2>
ωB97X-3c (2022)
</h2>

<p>
Finally, we come to <a href=https://pubs.aip.org/aip/jcp/article-abstract/158/1/014103/2867476/B97X-3c-A-composite-range-separated-hybrid-DFT?redirectedFrom=fulltext>ωB97X-3c</a>, a composite range-separated hybrid functional derived from Mardirossian and Head-Gordon’s <a href=https://pubs.rsc.org/en/content/articlelanding/2014/cp/c3cp54374a>ωB97X-V</a> functional (which seems to me to be one of the best DFT methods, period). ωB97X-3c reintroduces Fock exchange, so it’s significantly more expensive than r<sup>2</sup> SCAN-3c or B97-3c, but with this expense comes increased accuracy.
</p>

<p>
Interestingly, neither of the “weird” corrections (gCP or SRB) are employed for ωB97X-3c: it’s just an off-the-shelf unmodified functional, the now-standard D4 dispersion correction, and a specialized basis set. The authors acknowledge this:
</p>

<blockquote>
Although ωB97X-3c is designed mostly in the spirit of the other “3c” methods, the meaning and definition of the applied “three corrections” have changed over the years. As before, the acronym stands for the dispersion correction and for the specially developed AO basis set, but here for the compilation of ECPs, which are essential for efficiency, as a third modification.
</blockquote>

<p>
(But weren’t there ECPs before? Doesn’t even HF-3c have ECPs? Aren’t ECPs just part of the basis set? Just admit that this is a “2c” method, folks.)
</p>

<p>
The authors devote a lot of effort to basis-set optimization, because range-separated hybrids are so expensive that using a triple-zeta basis set like they did for B97-3c or r<sup>2</sup> SCAN-3c would ruin the speed of the method. This time, they do go into more details, and emphasize that the basis set (“vDZP”) was optimized on molecules and not just on single atoms:
</p>

<blockquote>
Molecule-optimized basis sets are rarely used in quantum chemistry. We are aware of the MOLOPT sets in the CP2K code and the polarization consistent (pc-n) basis sets by Jensen. In the latter, only the polarization functions are optimized with respect to molecular energies. A significant advantage of molecular basis set optimizations is that, contrary to atomic optimizations, all angular momentum functions (i.e., polarization functions not occupied in the atomic ground state) can be determined consistently, as already noted by VandeVondele and Hutter.
</blockquote>

<p>
They also put together a new set of effective core potentials, which also helps to minimize the number of basis functions. Even so, ωB97X-3c is the slowest of the composite methods, as shown in this figure:
</p>

<figure>
  <img class=centered-img src=../img/20230922_wb_speed.png style="width:450px;" />
  <figcaption>
  Slow, but still faster than the competition.
  </figcaption>
</figure>

<p>
In terms of accuracy, ωB97X-3c is far better than r<sup>2</sup> SCAN-3c, previously the best composite method, and is among the best-performing DFT methods in general for most benchmarks, although still outcompeted by ωB97X-V (and its close cousin ωB97X-D4, reparameterized in this work). The expense of ωB97X-3c means that for easy tasks like geometry optimization r<sup>2</sup> SCAN-3c is still probably a better choice, but for almost anything else it seems that ωB97X-3c is an excellent choice.
</p>

<figure>
  <img class=centered-img src=../img/20230922_wb_acc.png style="width:450px;" />
</figure>

<p>
An interesting observation is that ωB97X-3c is not just Pareto-optimal, but close to optimal in an absolute sense. I initially framed the goal of composite methods as finding new ways to increase speed while decreasing accuracy: but here it seems that we can gain a ton of speed without losing much accuracy at all! This should be somewhat surprising, and the implications will be discussed later.
</p>

<h2>
Overall Summary
</h2>

<p>
Excluding some of the more specific composite methods, there seem to be three tiers here:
</p>

<ol>
<li>
HF-3c, which is very fast but only reliable for geometry optimizations and pretty easy property calculations (e.g. dipole moment, rough frequencies). But also, geometry optimizations are ubiquitous, so this is still very important.
</li>
<li>
PBEh-3c, B97-3c, and r<sup>2</sup> SCAN-3c, which are all roughly the same speed despite substantial differences. Of these, PBEh-3c seems like the slowest and least accurate, and I’d be tempted to use either of the others first, especially r<sup>2</sup> SCAN-3c. (I’m curious about the tradeoffs that a mGGA functional has versus a GGA functional like B97-3c—are there pathological integration grid behaviors that B97-3c avoids? See Figure 6 <a href=https://pubs.aip.org/aip/jcp/article-abstract/157/17/174114/2842017/Many-recent-density-functionals-are-numerically>here</a>.)
</li>
<li>
ωB97X-3c, which seems to be in a class of its own, and better than almost everything else (not just other composites). That being said, it’s still new, and no one loves a method better than its own authors. We’ll have to see some real-world tests to make sure things are as promising as they seem.
</li>
</ol>

<h2>
Conclusions
</h2>

<p>
After decades of theorists mocking people for using small basis sets, it’s ironic that intentionally embracing cancellation of error is trendy again. I’m glad to see actual theorists turn their attention to this problem: people have never stopped using “inadequate” basis sets like 6-31G(d), simply because nothing larger is practical for many systems of interest!
</p>

<p>
The results from this body of work suggest that current basis sets are far from optimal, too. The only piece of ωB97X-3c that’s new is the basis set, and yet that seems to make a huge difference relative to state-of-the-art. What happens if vDZP is used for other methods, like B97? The authors suggest that it might be generally effective, but more work is needed to study this further. 
</p>

<p>
Basis-set optimization seems like a <a href=http://www.paulgraham.com/schlep.html>“schlep”</a> that people have avoided because of how annoying it is, or something which is practically useful but not very scientifically interesting or publishable. Perhaps the success of composite methods will push more people towards studying basis sets; I think that would be a good outcome of this research. It seems unlikely to me that vDZP cannot be optimized further; if the results above are any indication, the Pareto frontier of basis sets can be advanced much more.
</p>

<p>
I’m also curious if Grimme and friends would change HF-3c and the other early methods, knowing what they know now. Do better basis sets alleviate the need for gCP and SRB, or is that not possible with a minimal basis set? What about D3 versus D4 (which wasn’t available at the time)? Hopefully someone finds the time to go back and do this, because to my knowledge HF-3c sees a good amount of use.
</p>

<p>
Perhaps my favorite part of this work, though, is the ways in which composite methods reduce the degrees of freedom available to end users. “Classic” DFT has a ton of tunable parameters (functional, basis set, corrections, solvent models, thresholds, and so forth), and people frequently make inefficient or nonsensical choices when faced with this complexity. In contrast, composite methods make principled and opinionated choices for many of these variables, thus giving scientists a well-defined menu of options.
</p>

<p>
This also makes it easier for outsiders to understand what’s going on. I wrote about this <a href=https://corinwagen.github.io/public/blog/20220810_viewpoints_on_simulation.html>over a year ago</a>:
</p>

<blockquote>
While a seasoned expert can quickly assess the relative merits of BYLP/MIDI! and DSD-PBEP86/def2-TZVP, to the layperson it’s tough to guess which might be superior… The manifold diversity of parameters employed today is a sign of [computational chemistry]’s immaturity—in truly mature fields, there’s an accepted right way to do things.
</blockquote>

<p>
The simplicity of composite methods cuts down on the amount of things that you have to memorize in order to understand computational chemistry. You only have to remember “HF-3c is fast and sloppy,” rather than trying to recall how many basis functions pcseg-1 has or which Minnesota functional is good for main-group geometries.
</p>

<p>
So, I’m really optimistic about this whole area of research, and I’m excited that other labs are now working on similar things (I didn’t have space to cover everyone’s contributions, but here’s <a href=https://pubs.aip.org/aip/jcp/article/146/23/234105/195242/Effective-empirical-corrections-for-basis-set>counterpoise work from Head-Gordon</a> and <a href=https://pubs.acs.org/doi/10.1021/acs.jctc.7b01158>atom-centered potentials from DiLabio</a>). The next challenge will be to get these methods into the hands of actual practitioners…
</p>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20230904_eda.html'>EDA Scares Me</a></h2><i>September 4, 2023</i>
<p><i>
ICYMI: Ari and I announced our new company, <a href=https://www.rowansci.com/>Rowan</a>! We wrote an article about what we're hoping to build, which you can read <a href=https://rowansci.substack.com/p/why-were-building-rowan>here</a>. Also, this blog is now listed on <a href=https://rogue-scholar.org/>The Rogue Scholar</a>, meaning that posts have DOIs and can be easily cited.
</i></p>

<p>
Conventional quantum chemical computations operate on a collection of atoms and create a single wavefunction for the entire system, with an associated energy and possibly other properties. This is great, but sometimes we want to understand things in more detail. For instance, if we have a host <b>A</b> and two guests <b>B</b><sub>good</sub> and <b>B</b><sub>bad</sub>, a normal calculation would just tell us that E(<b>A</b>•<b>B</b><sub>good</sub>) is lower than E(<b>A</b>•<b>B</b><sub>bad</sub>), without giving any clue as to why.
</p>

<p>
Enter EDA. EDA, or “energy decomposition analysis,” is a family of techniques used to dissect interactions in a system with multiple molecules. In this case, an EDA calculation on the <b>AB</b> system would break down the interaction between <b>A</b> and <b>B</b> into various components, which could be used to help scientists understand the origin of the difference, and perhaps used for continued molecular design.
</p>

<p>
Unfortunately, EDA has always seemed like a pretty troubled technique to me. Wavefunctions are inherently not localized to individual fragments of a multimolecular system—you can’t just slice apart the molecular orbitals or the density matrix and end up with anything that’s physically sane. So you have to do some computational gymnastics to get energetic terms which are at all meaningful. Many such gymnastic workflows have been proposed, leading to a veritable alphabet soup of different EDA methods.
</p>

<p>
(It’s worth skimming <a href=https://onlinelibrary.wiley.com/doi/10.1002/jcc.26003>this review</a> on different EDA methods to get a sense for some of the questions the field faces, and also to laugh at how Alston Misquitta &amp; Krzysztof Szalewicz use the review as a chance to relentlessly advertise SAPT and denigrate any and all competing methods.)
</p>

<p>
I’ll briefly outline how the EDA-NCOV method works for a system <b>AB</b> (following <a href=https://wires.onlinelibrary.wiley.com/doi/epdf/10.1002/wcms.1345>this review</a>), to give a sense for the flavor of the field:
</p>

<ol>
<li>
Optimized ground-state fragments <b>A</b><sup>0</sup> and <b>B</b><sup>0</sup> are distorted to the geometries and electronic states (<b>A</b> &amp; <b>B</b>) which they possess in <b>AB</b>, and the energy required for this distortion/excitation is termed <i>E</i><sub>prep</sub>. (The difference between <i>E</i>(<b>AB</b>) and <i>E</i>(<b>A</b>) + <i>E</i>(<b>B</b>) is called <i>E</i><sub>int</sub>, and the total binding energy is equal to <i>E</i><sub>int</sub> + <i>E</i><sub>prep</sub>.)
</li>
<li>
The distorted fragments <b>A</b> and <b>B</b> are brought together (with frozen charge densities) to form the “promolecule” <b>AB</b><sup>0</sup>, and the change in energy is termed <i>E</i><sub>elstat</sub>, the quasiclassical Coulomb interaction energy (typically attractive). The wavefunction for <b>AB</b><sup>0</sup> is Ψ<sup>A</sup>Ψ<sup>B</sup>.
</li>
<li>
The product wavefunction Ψ<sup>A</sup>Ψ<sup>B</sup> is antisymmetrized and renormalized to give an “intermediate state” Ψ<sup>0</sup> with energy <i>E</i><sup>0</sup>, and the change in energy is termed <i>E</i><sub>Pauli</sub>, originating from Pauli repulsion. This component is always repulsive.
</li>
<li>
Ψ<sup>0</sup> is relaxed to yield the final wavefunction Ψ<sup>AB</sup>. The change in energy is termed <i>E</i><sub>orb</sub>, because it arises from orbital interactions, and is always attractive.
</li>
</ol>

<p>
Thus, <i>E</i><sub>int</sub> = <i>E</i><sub>elstat</sub> + <i>E</i><sub>Pauli</sub> + <i>E</i><sub>orb</sub>. (Dispersion can also be added if an exogenous dispersion correction is employed—that’s pretty trivial.)
</p>

<p>
The critical reader might observe that the steps taken to obtain these numbers are pretty odd, and that the components of the interaction energy arise from differences in energy between bizarre nonphysical states. Thus, the interpretation of terms like <i>E</i><sub>elstat</sub> in terms of actual physical interactions might not be as easy as it seems. The authors of the above review agree:
</p>

<blockquote>
It is important to realize that the identification of the three major terms Δ<i>E</i><sub>elstat</sub>, Δ<i>E</i><sub>Pauli</sub>, and Δ<i>E</i><sub>orb</sub> with specific interactions is conceptually attractive but must not be taken as genuine expression of the physical forces.
</blockquote>

<p>
Unfortunately, it seems that imprecise concepts familiar to experimental chemists like “steric repulsion” and “electrostatic attraction” have to be discarded in favor of precise terms like <i>E</i><sub>Pauli</sub>. Too bad they’re virtually uninterpretable!
</p>

<p>
And what’s worse is that different EDA-type schemes don’t even give the same results. <a href=https://pubs.acs.org/doi/10.1021/jacs.3c08196>A paper</a> out today in <i>JACS</i> from Zare/Shaik discusses the use of EDA and related schemes in studying the origin of the hydrogen bond (a pretty fundamental question), motivated by the substantial disagreement between various techniques: 
</p>

<blockquote>
It is important to realize that different methods (e.g., BOVB, ALMO-EDA, NEDA, and BLW) do not fully agree with one another about whether the dominant stabilizing term is Δ<i>E</i><sub>POL</sub> or Δ<i>E</i><sub>CT</sub> in a particular HB.
</blockquote>

<p>
While the authors make a good case that the sum of these two terms is relatively conserved across methods, and that it’s this term that we should care about for hydrogen bonds, the conclusions for EDA broadly are not encouraging. (Note, too, that <i>E</i><sub>POL</sub> and <i>E</i><sub>CT</sub> don’t even appear in the EDA-NCOV method summarized above—another reason that EDA is a frustrating field!)
</p>

<figure>
  <img class=centered-img src=../img/20230904_shoggoth.png style="width:550px;" />
  <figcaption>
  How I feel about EDA, borrowing <a href=https://www.nytimes.com/2023/05/30/technology/shoggoth-meme-ai.html>a meme from the AI discourse</a>.
  </figcaption>
</figure>
 
<p>
And even if the theorists eventually put their heads together and develop a version of EDA that doesn’t have these pitfalls, it’s still not clear that any form of EDA will give the answers that experimental chemists are looking for. Chemistry is complicated, and ground- or transition-state structures arise from a delicate equilibrium between opposing factors: steric repulsion, electrostatic attraction, bond distances, torsional strain, dispersion, &amp;c.
</p>

<p>
As a result, one can see large changes in the contribution of individual factors even while the overall structure’s stability is minimally perturbed (<a href=https://pubs.rsc.org/en/content/articlehtml/2014/md/c4md00057a>enthalpy–entropy compensation</a> is a classic example, as is Fig. 2 in <a href=https://onlinelibrary.wiley.com/doi/full/10.1002/anie.201701486>this review</a> on distortion–interaction analysis). Looking only at changes in individual factors isn’t always a useful way to gain insight from computation.
</p>

<p>
For example, imagine a nucleophile adding to two faces of an oxocarbenium, a bulky face and an unhindered face. Based on this description, we might expect to see that TS<sub>bulky</sub> has higher steric repulsion than TS<sub>unhindered</sub> (if we’re lucky enough to find a way to extract <i>E</i><sub>steric</sub> out of our EDA method). But it’s also likely that the nucleophile might take a less favorable trajectory towards the oxocarbenium in TS<sub>bulky</sub> to avoid steric repulsion, thus weakening key orbital interactions. These changes might even end up being larger in magnitude than the destabilization induced by steric repulsion. Is the correct answer, then, that TS<sub>bulky</sub> is higher in energy because of decreased <i>E</i><sub>orb</sub>, not increased <i>E</i><sub>steric</sub>?
</p>

<p>
The solution is to recognize that causation is not unique (cf. <a href=https://en.wikipedia.org/wiki/Four_causes>Aristotle</a>), and so there’s no one right answer here. Within the constraints of the EDA framework, the theorist wouldn’t be incorrect in saying that <i>E</i><sub>orb</sub> is the driving factor—but the experimental chemist might reasonably expect “the bulky TS is destabilized by steric repulsion” as their answer, since this is the root cause of the changes between the two structures. (I side with the experimentalists here.)
</p>

<p>
And the precisely defined concepts favored by theorists are often hard for experimental scientists to work with. Even if the correct answer in the above scenario were “<i>TS</i><sub>bulky</sub> is destabilized by decreased orbital overlap”—what’s an experimentalist supposed to do with this information, add more orbitals? (This is how I feel about Trevor Hamlin’s work on Pauli repulsion.) The steric explanation at least suggests an intuitive solution: make the bulky group or the nucleophile smaller. If the purpose of EDA is to help people to understand intermolecular interactions better on a conceptual level, I’m not sure it’s succeeding in most cases.
</p>

<p>
(The only use of EDA that led to an actual experimental advance which I’m aware of is Buchwald/Peng Liu’s body of work on ligand–substrate dispersion in hydrocupration: <a href=https://pubs.acs.org/doi/abs/10.1021/jacs.7b07373>study</a>, <a href=https://pubs.acs.org/doi/10.1021/jacs.8b09565>new ligand</a>, <a href=https://pubs.acs.org/doi/10.1021/jacs.0c08746>ligand from Hartwig</a>. I don’t think it’s a coincidence that these papers focus on dispersion, one of the easiest pieces of EDA to decouple and understand.)
</p>

<p>
I don’t mean to be too critical here. The ability to break intermolecular interactions down into different components is certainly useful, and it seems likely that some version of EDA will eventually achieve consensus and emerge as a useful tool. But I think the utility of EDA even in the best case is pretty limited. Quantum chemistry is complicated, and if we think we can break it down into easy-to-digest components and eliminate the full nonlocal majesty of the Schrodinger equation, we’re lying to ourselves (or our experimental collaborators). Compute with caution!
</p>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20230820_ts_polarizable.html'>Transition States Are Polarizable</a></h2><i>August 20, 2023</i>
<p><i>
Recently in off-blog content: I coauthored <a href=https://www.freaktakes.com/p/the-past-and-present-of-computer>an article with Eric Gilliam</a> on how LLMs can assist in hypothesis generation and help us all become more like Sharpless. Check it out!
</i></p>

<p>
The Pauling model for enzymatic catalysis states that enzymes are “antibodies for the transition state”—in other words, they preferentially bind to the transition state of a given reaction, rather than the reactants or products. This binding interaction stabilizes the TS, thus lowering its energy and accelerating the reaction.  
</p>

<p>
This is a pretty intuitive model, and one which is often employed when thinking about organocatalysis, particularly noncovalent organocatalysis. (It’s a bit harder to use this model when the mechanism changes in a fundamental way, as with many organometallic reactions.) Many transition states have distinctive features, and it’s fun to think about what interactions could be engineered to recognize and stabilize only these features and nothing else in the reaction mixture. 
</p>

<p>
(For instance, chymotrypsin contains a dual hydrogen-bond motif called the “<a href=https://en.wikipedia.org/wiki/Oxyanion_hole>oxyanion hole</a>” which stabilizes developing negative charge in the Burgi–Dunitz TS for alcoholysis of amides. The negative charge is unique to the tetrahedral intermediate and the high-energy TSs to either side, so reactant/product inhibition isn’t a big issue. This motif can be mimicked by dual hydrogen-bond donor organocatalysts like the one my PhD lab specialized in.) 
</p>

<p>
The downside of this approach to catalyst design is that each new sort of reaction mechanism requires a different sort of catalyst. One TS features increasing negative charge at one place, while another features increasing positive charge at another, and a third is practically charge-neutral the whole way through. What if there were some feature that was common to all transition states? 
</p>

<p>
A recent <a href=https://chemrxiv.org/engage/chemrxiv/article-details/64def1de694bf1540c8b1e3c?s=03>preprint</a> from Diptarka Hait and Martin Head-Gordon suggests an interesting answer to this question: polarizability. (Diptarka, despite just finishing his PhD, is a <a href=https://scholar.google.com/citations?user=R2WrGKMAAAAJ&hl=en>prolific</a> scientist with a ton of different interests, and definitely someone to keep an eye on.) The authors tackle the question of when precisely a stretching bond can be considered “broken.” An intuitive answer might be “the transition state,” but as the paper points out, plenty of bond-breaking potential energy surfaces lack clear transition states (e.g. H<sub>2</sub>, pictured below in red). 
</p>

<figure>
  <img class=centered-img src=../img/20230820_polariz.png style="width:450px;" />
  <figcaption>
  Hydrogen PES (red), with various polarizability components shown in blue.
  </figcaption>
</figure>

<p>
Instead, the authors propose that polarizability is a good way to study this question. As seen in the following graph, polarizability (particularly α<sub>||</sub>, the component parallel to the bond axis) first increases as a bond is stretched, and then decreases, with a sharp and easily identifiable maximum about where a bond might be considered to be broken. This metric tracks with the conventional PES metric in cases where the PES is well-defined (see Fig. 5), which is comforting. Why does this occur?
</p>

<blockquote>
The evolution of α [polarizability] can be rationalized in the following manner. Upon initially stretching H2 from equilibrium, the bonding electrons fill up the additional accessible volume, resulting in a more diffuse (and thus more polarizable) electron density. Post bond cleavage however, the electrons start localizing on individual atoms, leading to a decrease in polarizability.
</blockquote>

<p>
In other words, electrons that are “caught in the act” of reorganizing between different atoms are more polarizable, whereas electrons which have settled into their new atomic residences are less polarizable again.
</p>

<p>
This is cool, but how can we apply this to catalysis? As it happens, there are already a few publications (<a href=https://pubs.acs.org/doi/abs/10.1021/jo960521y>1</a>, <a href=https://pubs.acs.org/doi/abs/10.1021/jo960521y>2</a>) from Dennis Dougherty and coworkers dealing with exactly this question. They show that cyclophanes are potent catalysts for S<sub>N</sub>2-type reactions that both create and destroy cations, and argue that polarizability, rather than any charge-recognition effect, undergirds the observed catalysis:
</p>

<blockquote>
Since transition states have long, weak bonds, they are expected to be more polarizable than ground-state substrates or products. The role of the host is to surround the transition state with an electron-rich-system that is polarizable and in a relatively fixed orientation, so that induced dipoles in both the host and the transition state are suitably aligned… Note that in this model, it is not sufficient that polarizability contributes to binding. Polarizability must be more important for binding transition states than for binding ground states. Only in this way can it enhance catalysis.
</blockquote>

<p>
To defend this argument, the authors prepare a series of variously substituted cyclophanes, and show that while Hammett-type electronic tuning of the aryl rings has relatively small effects, adding more heavy atoms always increases the rate, with the biggest effect observed with bromine (the heaviest element attempted). Heavier atoms are more polarizable, so this supports the argument that polarizability, rather than any specific electrostatic effect, is responsible for catalysis. 
</p>

<figure>
  <img class=centered-img src=../img/20230820_cyclophane.png style="width:450px;" />
  <figcaption>
  The cyclophanes used as catalysts: Y=Br is the best.
  </figcaption>
</figure>

<p>
The Dougherty work is performed on a very specific model system, and the absolute rate accelerations seen aren’t massive (about twofold increase relative to the protio analog), so it’s not clear that this will actually be a promising avenue for developing mechanism-agnostic catalysts. 
</p>

<p>
But I think this line of research is really interesting, and merits further investigation. Pericyclic reactions, which involve large electron clouds and multiple forming–breaking bonds and often feature minimal development of partial charges, seem promising targets for this sort of catalysis—what about the carbonyl–ene reaction or something similar? The promise of new catalytic strategies that complement existing mechanism-specific interactions is just too powerful to leave unstudied. 
</p>

<i>
Thanks to Joe Gair for originally showing me the Dougherty papers referenced.
</i>

</div><div class='blogroll-container'><h2><a class='blogroll-title' href='../../public/blog/20230804_abundance.html'>How Common Are Different Functional Groups?</a></h2><i>August 4, 2023</i>
<p>
Since the ostensible purpose of organic methodology is to develop reactions that are useful in the real world, the utility of a method is in large part dictated by the accessibility of the starting materials. If a compound is difficult to synthesize or hazardous to work with, then it’s difficult to convince people to use it in a reaction (e.g. most diazoalkanes). Organic chemists are pragmatic, and would usually prefer to run a reaction that starts from a commercial and bench-stable starting material. 
</p>

<p>
For instance, this explains the immense popularity of the Suzuki reaction: although the Neigishi reaction (using organozinc nucleophiles) usually works better for the same substrates, you can buy lots of the organoboron nucleophiles needed to run a Suzuki and leave them lying around without taking any precautions. In contrast, organozinc compounds usually have to be made from the corresponding organolithium/Grignard reagent and used freshly, which is considerably more annoying.
</p>

<p>
The ideal starting material, then, is one which is commercially available and cheap. In recent years, it’s become popular to advertise new synthetic methods by showing that they work on exceptionally cheap and common functional groups, and in particular to compare the abundance of different functional groups to demonstrate that one starting material is more common than another. To pick just one of many examples, Dave MacMillan used this plot to show why cross-coupling reactions of alcohols were important (<a href=https://macmillan.princeton.edu/wp-content/uploads/Zhe.pdf>ref</a>):
</p>

<figure>
  <img class=centered-img src=../img/20230804_macmillan.png style="width:500px;" />
  <figcaption>
  This visual works really well.
  </figcaption>
</figure>

<p>
When I saw MacMillan’s talk at MIT last year, I was curious what it would take to make additional graphics like this. The “number of reactions” plot can be made pretty easily from Reaxys, but I’ve always been uncertain how the “number of commercial sources” plots are made: I haven’t seen references listed for these numbers, nor is anything usually found in the Supporting Information. 
</p>

<p>
I decided to take a swing at getting this data myself by analyzing the <a href=https://mcule.com/database/>Mcule</a> "building blocks" database, which contains about 3.5 million compounds. Although Mcule doesn't define what a building block is (at least, not that I can find), it’s likely that their definition is similar to that of ZINC, which defines building blocks as “those catalogs of compounds available in preparative quantities, typically 250 mg or more” (<a href=https://pubs.acs.org/doi/pdf/10.1021/acs.jcim.5b00559>ref</a>). This seems like a reasonable proxy for the sorts of compounds synthetic chemists might use in reactions. I defined patterns to match a bunch of functional groups using SMARTS/SMILES, and then used RDKit to find matches in the Mcule building blocks database. The code can be found on <a href=https://github.com/corinwagen/scratchpad/tree/master/mcule>Github</a>, along with the patterns I used.
</p>

<p>
The results are shown below. As expected, ethers, amines, amides, and alcohols are quite common. Surprisingly, aryl chlorides aren't that much more common than aryl bromides—and, except for aliphatic fluorides, all aliphatic halides are quite rare. Allenes, carbodiimides, and SF5 groups are virtually unheard of (&lt;100 examples).
</p>

<table class=left-aligned-table>
  <tr>
    <th>Functional Group</th>
    <th>Number</th>
    <th>Percent</th>
  </tr>
	<tr>
		<td>acid chloride</td>
		<td>6913</td>
		<td>0.19</td>
	</tr>
	<tr>
		<td>alcohol</td>
		<td>1022229</td>
		<td>28.60</td>
	</tr>
	<tr>
		<td>aliphatic bromide</td>
		<td>42018</td>
		<td>1.18</td>
	</tr>
	<tr>
		<td>aliphatic chloride</td>
		<td>70410</td>
		<td>1.97</td>
	</tr>
	<tr>
		<td>aliphatic fluoride</td>
		<td>650576</td>
		<td>18.20</td>
	</tr>
	<tr>
		<td>aliphatic iodide</td>
		<td>3159</td>
		<td>0.09</td>
	</tr>
	<tr>
		<td>alkene</td>
		<td>176484</td>
		<td>4.94</td>
	</tr>
	<tr>
		<td>alkyne</td>
		<td>35577</td>
		<td>1.00</td>
	</tr>
	<tr>
		<td>allene</td>
		<td>99</td>
		<td>0.00</td>
	</tr>
	<tr>
		<td>amide</td>
		<td>518151</td>
		<td>14.50</td>
	</tr>
	<tr>
		<td>anhydride</td>
		<td>1279</td>
		<td>0.04</td>
	</tr>
	<tr>
		<td>aryl bromide</td>
		<td>451451</td>
		<td>12.63</td>
	</tr>
	<tr>
		<td>aryl chloride</td>
		<td>661591</td>
		<td>18.51</td>
	</tr>
	<tr>
		<td>aryl fluoride</td>
		<td>618620</td>
		<td>17.31</td>
	</tr>
	<tr>
		<td>aryl iodide</td>
		<td>216723</td>
		<td>6.06</td>
	</tr>
	<tr>
		<td>azide</td>
		<td>5164</td>
		<td>0.14</td>
	</tr>
	<tr>
		<td>aziridine</td>
		<td>748</td>
		<td>0.02</td>
	</tr>
	<tr>
		<td>carbamate</td>
		<td>127103</td>
		<td>3.56</td>
	</tr>
	<tr>
		<td>carbodiimide</td>
		<td>28</td>
		<td>0.00</td>
	</tr>
	<tr>
		<td>carbonate</td>
		<td>1231</td>
		<td>0.03</td>
	</tr>
	<tr>
		<td>carboxylic acid</td>
		<td>410860</td>
		<td>11.49</td>
	</tr>
	<tr>
		<td>chloroformate</td>
		<td>250</td>
		<td>0.01</td>
	</tr>
	<tr>
		<td>cyclobutane</td>
		<td>195728</td>
		<td>5.48</td>
	</tr>
	<tr>
		<td>cyclopropane</td>
		<td>349455</td>
		<td>9.78</td>
	</tr>
	<tr>
		<td>diene</td>
		<td>10188</td>
		<td>0.29</td>
	</tr>
	<tr>
		<td>difluoromethyl</td>
		<td>163395</td>
		<td>4.57</td>
	</tr>
	<tr>
		<td>epoxide</td>
		<td>5859</td>
		<td>0.16</td>
	</tr>
	<tr>
		<td>ester</td>
		<td>422715</td>
		<td>11.83</td>
	</tr>
	<tr>
		<td>ether</td>
		<td>1434485</td>
		<td>40.13</td>
	</tr>
	<tr>
		<td>isocyanate</td>
		<td>1440</td>
		<td>0.04</td>
	</tr>
	<tr>
		<td>isothiocyanate</td>
		<td>1389</td>
		<td>0.04</td>
	</tr>
	<tr>
		<td>nitrile</td>
		<td>209183</td>
		<td>5.85</td>
	</tr>
	<tr>
		<td>nitro</td>
		<td>126200</td>
		<td>3.53</td>
	</tr>
	<tr>
		<td>pentafluorosulfanyl</td>
		<td>18</td>
		<td>0.00</td>
	</tr>
	<tr>
		<td>primary amine</td>
		<td>904118</td>
		<td>25.29</td>
	</tr>
	<tr>
		<td>secondary amine</td>
		<td>857290</td>
		<td>23.98</td>
	</tr>
	<tr>
		<td>tertiary amine</td>
		<td>609261</td>
		<td>17.04</td>
	</tr>
	<tr>
		<td>trifluoromethoxy</td>
		<td>18567</td>
		<td>0.52</td>
	</tr>
	<tr>
		<td>trifluoromethyl</td>
		<td>455348</td>
		<td>12.74</td>
	</tr>
	<tr>
		<td>urea</td>
		<td>518151</td>
		<td>14.50</td>
	</tr>
	<tr>
		<td><i>Total</i></td>
		<td><i>3574611</i></td>
		<td><i>100.00</i></td>
	</tr>
</table>

<p>
(Fair warning: I’ve spotchecked a number of the SMILES files generated (also on <a href=https://github.com/corinwagen/scratchpad/tree/master/mcule/output>Github</a>), but I haven’t looked through every molecule, so it’s possible that there are some faulty matches. I wouldn’t consider these publication-quality numbers yet.)
</p>

<p>
An obvious caveat: there are lots of commercially “rare” functional groups which are easily accessible from more abundant functional groups. For instance, acid chlorides seem uncommon in the above table, but can usually be made from ubiquitous carboxylic acids with e.g. SOCl2. So these data shouldn’t be taken as a proxy for a more holistic measure of synthetic accessibility—they measure commercial availability, that’s all. 
</p>

<p>
What conclusions can we draw from this?
</p>

<ul>
<li>
The most common functional groups are the milquetoast ones: alcohols, amines, esters, etc. Perhaps this explains <a href=https://pubs.acs.org/doi/pdf/10.1021/acs.jmedchem.5b01409>where all the new reactions have gone</a>: unless your new method works on alcohols or amines, it will struggle to get traction in most of chemical space relative to e.g. Williamson ether synthesis or reductive amination. (Kudos to MacMillan for identifying this; <i>vide supra</i>.)
</li>
<li>
Ureas are much more common than you’d expect from academic methods papers. This I think speaks to the difference between what methodologists want and what medicinal chemists want. Ureas are a bit annoying to work with: they’re pretty polar by the standards of academia, they’re not always soluble in organic solvents, and they have a tendency to stick to transition metal catalysts or get deprotonated by strong bases. But they’re easy to make in libraries, since the isocyanate/amine disconnection is so robust, and they’re excellent hydrogen-bond donors and acceptors.
<b>CORRECTION: There's a SMARTS error, so the match for "ureas" actually matches amides—disregard this section. Thanks to <a href=https://twitter.com/wmdhn>@wmdhn</a> for catching this.</a></b>
</li>
<li>
Uncommon functional groups, like SF<sub>5</sub> and allenes, are very uncommon. If you want to introduce an SF<sub>5</sub> group, you are in for a rough time: there aren’t great ways to add it to molecules (although there have been some steps forward <a href=https://chemistry-europe.onlinelibrary.wiley.com/doi/10.1002/chem.202201491>in recent years</a>), and there are only 18 commercial examples. So people can write as many <a href=https://www.ncbi.nlm.nih.gov/pmc/articles/PMC7728329/>papers</a> as they want about how cool SF<sub>5</sub> groups are: I still doubt we’ll see them used very much in the near future.
</li>
<li>
But also, the abundance of a given functional group is very elastic in the long run. Trifluoromethyl groups used to be extremely rare—they’re not found in nature!—but now 1 in 8 molecules has a CF<sub>3</sub> group. CF<sub>3</sub> just turns out to be a very good handle for a lot of molecular design tasks, and so people found ways to introduce it all over the place, and now it’s not hard to get molecules that have trifluoromethyl groups. Synthetic chemists should feel good about this.
</li>
</ul>

<p>
The functional-group-specific SMILES files are in the previously mentioned Github repo, so anyone who wants to e.g. look through all the commercially available alkenes and perform further cheminformatics analyses can do so. I hope the attached code and data helps other chemists perform similar, and better, studies, and that this sort of thinking can be useful for those who are currently engaged in reaction discovery. 
</p>

<i>
Thanks to Eric Jacobsen for helpful conversations about these data.
</i>

</div><div class='previous-link'><a href='blog_p2.html'>previous page</a></div><div class='next-link'><a href='blog_p4.html'>next page</a></div><br>
  </body>
  <br>
  <footer>
    <a href="mailto:corin.wagen+blog@gmail.com">email</a>
    <a href="https://github.com/corinwagen">github</a>
    <a href="https://twitter.com/CorinWagen">twitter</a>
    <div style="float:right;">
      <a href="/rss.xml">rss</a>
      <a href="https://cwagen.substack.com">substack</a>
    </div>
  </footer>
</html>
